(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(e,t,n){"use strict";n.d(t,"h",function(){return s}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"a",function(){return v}),n.d(t,"b",function(){return f}),n.d(t,"f",function(){return h}),n.d(t,"e",function(){return m}),n.d(t,"g",function(){return k});var r=n(5),a=n(4),i=n(2),u=n(3),c=function(){function e(){Object(i.a)(this,e),this.ilineStart=void 0,this.icolStart=void 0,this.ilineEnd=void 0,this.icolEnd=void 0}return Object(u.a)(e,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"withSourceInfo",value:function(e,t){return this.ilineStart=e.ilineStart,this.icolStart=e.icolStart,this.ilineEnd=t.ilineEnd,this.icolEnd=t.icolEnd,this}}]),e}(),o=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,null,[{key:"matches",value:function(e){return!d.matches(e)}}]),n}(c),s=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this)).cont=e,a.val=r,a}return Object(u.a)(n,null,[{key:"matches",value:function(e){return e instanceof n}},{key:"cast",value:function(e){if(!n.matches(e))throw"Breakpoint expected";return e}},{key:"call",value:function(e){return n.cast(e).cont(e.val)}}]),n}(c),l=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this))._val=e,a._env=r,a}return Object(u.a)(n,[{key:"env",value:function(){return this._env}},{key:"val",value:function(){return this._val}},{key:"toString",value:function(){return"T("+this._val.toString()+")"}},{key:"toDisplayString",value:function(){return""}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"cast",value:function(e){if(!n.matches(e))throw"Breakpoint expected";return e}}]),n}(c),d=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this))._car=e,a._cdr=r,a}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toStringI(function(e){return e.toDisplayString()})}},{key:"toString",value:function(){return this.toStringI(function(e){return e.toString()})}},{key:"toStringI",value:function(e){for(var t="(",r=!0,a=this;!n.isNil(a);){if(r||(t+=" "),r=!1,!n.matches(a)){t+=e(a);break}if(t+=e(n.car(a)),a=n.cdr(a),o.matches(a)){t+=" . "+e(a);break}}return t+=")"}}],[{key:"cons",value:function(e,t){return new n(e,t)}},{key:"listFromRvs",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.listFromRvArray(t)}},{key:"listFromRvArray",value:function(e){for(var t=n.Nil,r=e.length-1;r>=0;r--)t=new n(e[r],t);return t}},{key:"matches",value:function(e){return e instanceof n}},{key:"isNil",value:function(e){return e===n.Nil||n.matches(e)&&null===n.car(e)&&null===n.cdr(e)}},{key:"val",value:function(e){return v.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"Cons expected";return e}},{key:"car",value:function(e){return n.cast(e)._car}},{key:"cdr",value:function(e){return n.cast(e)._cdr}},{key:"setCar",value:function(e,t){return n.cast(e)._car=t,e}},{key:"setCdr",value:function(e,t){return n.cast(e)._cdr=t,e}},{key:"cadr",value:function(e){return this.car(this.cdr(e))}},{key:"cddr",value:function(e){return this.cdr(this.cdr(e))}},{key:"caddr",value:function(e){return this.car(this.cddr(e))}},{key:"cdddr",value:function(e){return this.cdr(this.cddr(e))}},{key:"cddddr",value:function(e){return this.cdr(this.cdddr(e))}},{key:"cadddr",value:function(e){return this.car(this.cdddr(e))}},{key:"caddddr",value:function(e){return this.car(this.cddddr(e))}},{key:"lengthI",value:function(e){for(var t=0;!this.isNil(e);)t++,e=this.cdr(e);return new m(t)}}]),n}(c);d.Nil=new d(null,null);var v=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return""}},{key:"toString",value:function(){return this._val.toString()}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"any expected";return e}}]),n}(c),f=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return this._val?"#t":"#f"}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"isTrue",value:function(e){return n.matches(e)&&n.val(e)}},{key:"isFalse",value:function(e){return n.matches(e)&&!n.val(e)}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"bool expected";return e}},{key:"not",value:function(e){return this.isTrue(e)?n.False:n.True}},{key:"and",value:function(e){for(;!d.isNil(e);){if(!this.isTrue(d.car(e)))return n.False;e=d.cdr(e)}return n.True}},{key:"or",value:function(e){for(;!d.isNil(e);){if(this.isTrue(d.car(e)))return n.True;e=d.cdr(e)}return n.False}},{key:"fromBoolean",value:function(e){return e?n.True:n.False}}]),n}(c);f.True=new f(!0),f.False=new f(!1);var h=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this._val}},{key:"toString",value:function(){return JSON.stringify(this._val)}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"string expected";return e}}]),n}(c),m=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return""+this._val}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"Number expected";return e}}]),n}(c),k=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return this._val}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"Symbol expected";return e}}]),n}(c)},20:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Parser});var _Users_encse_projects_mini_scheme_sicp_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_Users_encse_projects_mini_scheme_sicp_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_Sv__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),Parser=function(){function Parser(){Object(_Users_encse_projects_mini_scheme_sicp_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,Parser),this.regexSymbol=/^[^\s()',]+/,this.regexNumber=/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/,this.regexString=/^"([^\\\"]+|\\.)*"/,this.regexWhiteSpace=/^\s*/,this.regexBoolean=/^#t|^#f/,this.regexComment=/^;.*/,this.tokens=void 0,this.itoken=0}return Object(_Users_encse_projects_mini_scheme_sicp_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(Parser,[{key:"parse",value:function(e){this.tokens=this.getTokens(e).filter(function(e){return e.kind!==TokenKind.WhiteSpace&&e.kind!==TokenKind.Comment});var t=this.tokens.length?this.tokens[this.tokens.length-1]:null;this.tokens.push(t?new Token(TokenKind.EOF,"",t.ilineEnd,t.icolEnd+1):new Token(TokenKind.EOF,"",0,0)),this.itoken=0;for(var n=[];!this.accept(TokenKind.EOF);)n.push(this.parseExpression());return _Sv__WEBPACK_IMPORTED_MODULE_2__.d.listFromRvArray(n)}},{key:"nextToken",value:function(){this.itoken<this.tokens.length-1&&this.itoken++}},{key:"currentToken",value:function(){return this.tokens[this.itoken]}},{key:"accept",value:function(e){return this.currentToken().kind===e&&(this.nextToken(),!0)}},{key:"expect",value:function(e){if(this.accept(e))return!0;throw"expected "+e+" found "+this.currentToken().kind}},{key:"parseExpression",value:function parseExpression(){var token=this.currentToken();if(this.accept(TokenKind.Quote)){var svBody=this.parseExpression();return new _Sv__WEBPACK_IMPORTED_MODULE_2__.d(new _Sv__WEBPACK_IMPORTED_MODULE_2__.g("quote"),svBody).withSourceInfo(token,svBody)}if(this.accept(TokenKind.Symbol))return new _Sv__WEBPACK_IMPORTED_MODULE_2__.g(token.st).withSourceInfo(token,token);if(this.accept(TokenKind.BooleanLit))return _Sv__WEBPACK_IMPORTED_MODULE_2__.b.fromBoolean("#t"===token.st).withSourceInfo(token,token);if(this.accept(TokenKind.NumberLit))return new _Sv__WEBPACK_IMPORTED_MODULE_2__.e(eval(token.st)).withSourceInfo(token,token);if(this.accept(TokenKind.StringLit))return new _Sv__WEBPACK_IMPORTED_MODULE_2__.f(eval(token.st)).withSourceInfo(token,token);if(this.accept(TokenKind.LParen)){for(var tokenStart=token,exprs=[];!this.accept(TokenKind.RParen);){if(this.accept(TokenKind.EOF))throw"unexpected end of input";exprs.push(this.parseExpression())}var tokenEnd=this.tokens[this.itoken-1];return _Sv__WEBPACK_IMPORTED_MODULE_2__.d.listFromRvArray(exprs).withSourceInfo(tokenStart,tokenEnd)}throw"invalid token "+token}},{key:"getTokens",value:function(e){for(var t=[],n=0,r=0;e.length>0;){var a=e[0],i=void 0;if("("===a)i=new Token(TokenKind.LParen,a,n,r);else if(")"===a)i=new Token(TokenKind.RParen,a,n,r);else if("'"===a)i=new Token(TokenKind.Quote,a,n,r);else if(this.regexNumber.test(e))i=new Token(TokenKind.NumberLit,this.regexNumber.exec(e)[0],n,r);else if(this.regexString.test(e))i=new Token(TokenKind.StringLit,this.regexString.exec(e)[0],n,r);else if(this.regexBoolean.test(e))i=new Token(TokenKind.BooleanLit,this.regexBoolean.exec(e)[0],n,r);else if(this.regexComment.test(e))i=new Token(TokenKind.Comment,this.regexComment.exec(e)[0],n,r);else if(this.regexSymbol.test(e))i=new Token(TokenKind.Symbol,this.regexSymbol.exec(e)[0],n,r);else{if(!this.regexWhiteSpace.test(e))throw"invalid token at '"+e+"'";i=new Token(TokenKind.WhiteSpace,this.regexWhiteSpace.exec(e)[0],n,r)}if(t.push(i),0===i.st.length)throw"invalid token";e=e.substr(i.st.length),n=i.ilineEnd,r=i.icolEnd}return t}}]),Parser}(),TokenKind;!function(e){e[e.WhiteSpace=0]="WhiteSpace",e[e.BooleanLit=1]="BooleanLit",e[e.LParen=2]="LParen",e[e.RParen=3]="RParen",e[e.Symbol=4]="Symbol",e[e.NumberLit=5]="NumberLit",e[e.Quote=6]="Quote",e[e.StringLit=7]="StringLit",e[e.Comment=8]="Comment",e[e.EOF=9]="EOF"}(TokenKind||(TokenKind={}));var Token=Object(_Users_encse_projects_mini_scheme_sicp_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(function e(t,n,r,a){Object(_Users_encse_projects_mini_scheme_sicp_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,e),this.kind=t,this.st=n,this.ilineStart=r,this.icolStart=a,this.ilineEnd=void 0,this.icolEnd=void 0;var i=n.replace("\r","").split("\n");this.ilineEnd=this.ilineStart+i.length-1,this.ilineStart===this.ilineEnd?this.icolEnd=a+i[0].length:this.icolEnd=i[i.length-1].length})},21:function(e,t,n){e.exports=n(39)},35:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(17),u=n.n(i),c=n(6),o=n(10),s=n.n(o),l=n(18),d=n(7),v=n(2),f=n(3),h=n(19),m=n.n(h),k=(n(35),n(36),n(38),function(){function e(t,n){Object(v.a)(this,e),this._sv=t,this._env=n}return Object(f.a)(e,[{key:"sv",value:function(){return this._sv}},{key:"env",value:function(){return this._env}},{key:"parent",value:function(){return this._env.getParentStackFrame()}}]),e}()),g=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(v.a)(this,e),this.obj={},this.envParent=null,this.svSymbolProcedure=void 0,this.parentStackFrame=void 0,this.envParent=t,this.svSymbolProcedure=n,this.parentStackFrame=r}return Object(f.a)(e,[{key:"getNames",value:function(){var e=[];for(var t in this.obj)this.obj.hasOwnProperty(t)&&e.push(t);return e}},{key:"getEnvParent",value:function(){return this.envParent}},{key:"getSvSymbolProcedure",value:function(){return this.svSymbolProcedure}},{key:"getParentStackFrame",value:function(){return this.parentStackFrame?this.parentStackFrame:this.envParent?this.envParent.getParentStackFrame():null}},{key:"get",value:function(e){if(e in this.obj)return this.obj[e];if(null==this.envParent)throw"no binding for "+e;return this.envParent.get(e)}},{key:"set",value:function(e,t){if(e in this.obj)this.obj[e]=t;else{if(null==this.envParent)throw e+" is not declared";this.envParent.set(e,t)}}},{key:"define",value:function(e,t){if(e in this.obj)throw e+" is already defined";this.obj[e]=t}},{key:"setOrDefine",value:function(e,t){this.obj[e]=t}}]),e}(),p=n(20),_=n(0),b=function(){function e(){Object(v.a)(this,e),this.stepCount=1,this.step=0,this.evaluators=void 0}return Object(f.a)(e,[{key:"setEvaluators",value:function(e){this.evaluators=e}},{key:"setStepCount",value:function(e){this.stepCount=e,this.step=0}},{key:"matches",value:function(e){return!0}},{key:"evaluate",value:function(e,t,n){for(var r=this,a=0;a<this.evaluators.length;a++)if(this.evaluators[a].matches(e))return this.step++,this.step%this.stepCount==0?new _.c(function(){return r.evaluators[a].evaluate(e,t,n)},t).withSourceInfo(e,e):this.evaluators[a].evaluate(e,t,n);throw"cannot evaluate "+e.toString()}},{key:"evaluateList",value:function(e,t,n){var r=this,a=_.d.Nil;return function e(i){return _.d.isNil(i)?new _.h(n,a):r.evaluate(_.d.car(i),t,function(t){a=t;var n=_.d.cdr(i);return e(n)})}(e)}}],[{key:"isTaggedList",value:function(e,t){if(!_.d.matches(e))return!1;var n=_.d.car(e);return _.g.matches(n)&&_.g.val(n)===t}}]),e}(),y=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return _.d.matches(e)}},{key:"evaluate",value:function(t,n,r){var a=this;return this.evaluator.evaluate(e.getOperator(t),n,function(i){if(!e.isPrimitiveProcedure(i)&&!e.isCompoundProcedure(i)&&!e.isContinuation(i))throw"undefined procedure "+e.getOperator(t).toString();return a.evaluateArgs(e.getArguments(t),n,function(u){return e.evalCall(i,u,new k(t,n),r,a.evaluator)})})}},{key:"evaluateArgs",value:function(e,t,n){var r=this,a=new _.d(null,null);return function e(i,u){return _.d.isNil(u)?new _.h(n,a):r.evaluator.evaluate(_.d.car(u),t,function(t){return _.d.setCar(i,t),_.d.setCdr(i,new _.d(null,null)),e(_.d.cdr(i),_.d.cdr(u))})}(a,e)}}],[{key:"evalCall",value:function(e,t,n,r,a){if(this.isPrimitiveProcedure(e))return new _.h(r,this.getPrimitiveProcedureDelegate(e)(t));if(this.isContinuation(e)){var i=_.d.Nil;if(!_.d.isNil(t)){if(!_.d.isNil(_.d.cdr(t)))throw"too many argument";i=_.d.car(t)}return this.getContinuationFromCapturedContinuation(e)(i)}if(this.isCompoundProcedure(e)){for(var u=new g(this.getProcedureEnv(e),this.getProcedureSymbol(e),n),c=this.getProcedureParameters(e);!_.d.isNil(t)||!_.d.isNil(c);){if(_.d.isNil(t))throw"not enough argument";if(_.d.isNil(c))throw"too many argument";var o=_.g.val(_.d.car(c)),s=_.d.car(t);u.define(o,s),c=_.d.cdr(c),t=_.d.cdr(t)}return a.evaluateList(this.getProcedureBody(e),u,r)}throw"undefined procedure"+e.toString()}},{key:"isCompoundProcedure",value:function(e){return b.isTaggedList(e,"procedure")}},{key:"isPrimitiveProcedure",value:function(e){return b.isTaggedList(e,"primitive")}},{key:"isContinuation",value:function(e){return b.isTaggedList(e,"captured-continuation")}},{key:"getContinuationFromCapturedContinuation",value:function(e){return _.a.val(_.d.cdr(e))}},{key:"getProcedureSymbol",value:function(e){return _.g.cast(_.d.cadr(e))}},{key:"getProcedureParameters",value:function(e){return _.d.caddr(e)}},{key:"getProcedureBody",value:function(e){return _.d.cadddr(e)}},{key:"getProcedureEnv",value:function(e){return _.a.val(_.d.caddddr(e))}},{key:"getPrimitiveProcedureDelegate",value:function(e){return _.a.val(_.d.cdr(e))}},{key:"getOperator",value:function(e){return _.d.car(e)}},{key:"getArguments",value:function(e){return _.d.cdr(e)}}]),e}(),w=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return b.isTaggedList(e,"begin")}},{key:"evaluate",value:function(e,t,n){return this.evaluator.evaluateList(this.getBeginActions(e),t,n)}},{key:"getBeginActions",value:function(e){return _.d.cdr(e)}}]),e}(),S=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return _.c.matches(e)}},{key:"evaluate",value:function(e,t,n){return new _.h(n,_.c.cast(e).val()())}}]),e}(),E=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return b.isTaggedList(e,"call-with-current-continuation")}},{key:"evaluate",value:function(t,n,r){var a=this;return this.evaluator.evaluate(this.getLambda(t),n,function(i){var u=_.d.listFromRvs(e.createCcProcedure(r));return y.evalCall(i,u,new k(t,n),r,a.evaluator)})}},{key:"getLambda",value:function(e){return _.d.cadr(e)}}],[{key:"createCcProcedure",value:function(e){return new _.d(new _.g("captured-continuation"),new _.a(e))}}]),e}(),O=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return b.isTaggedList(e,"cond")}},{key:"getCondClauses",value:function(e){return _.d.cdr(e)}},{key:"isCondElseClause",value:function(e){return b.isTaggedList(e,"else")}},{key:"getCondPredicate",value:function(e){return _.d.car(e)}},{key:"getCondActions",value:function(e){return _.d.cdr(e)}},{key:"evaluate",value:function(e,t,n){var r=this;return function e(a){if(_.d.isNil(a))return new _.h(n,a);var i=_.d.car(a);return r.isCondElseClause(i)?r.evaluator.evaluateList(r.getCondActions(i),t,n):r.evaluator.evaluate(_.d.car(i),t,function(u){if(_.b.isTrue(u))return r.evaluator.evaluateList(r.getCondActions(i),t,n);var c=_.d.cdr(a);return e(c)})}(this.getCondClauses(e))}}]),e}(),j=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return b.isTaggedList(e,"lambda")}},{key:"evaluate",value:function(t,n,r){var a=e.createCompoundProcedure(new _.g("lambda"),e.getLambdaParameters(t),e.getLambdaBody(t),n);return new _.h(r,a)}}],[{key:"createCompoundProcedure",value:function(e,t,n,r){return _.d.listFromRvs(new _.g("procedure"),e,t,n,new _.a(r))}},{key:"getLambdaParameters",value:function(e){return _.d.cadr(e)}},{key:"getLambdaBody",value:function(e){return _.d.cddr(e)}}]),e}(),P=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return b.isTaggedList(e,"define")}},{key:"evaluate",value:function(e,t,n){var r=this;if(_.d.matches(this.getHead(e))){var a=j.createCompoundProcedure(this.getFunctionName(e),this.getLambdaParameters(e),this.getLambdaBody(e),t);return t.define(_.g.val(this.getFunctionName(e)),a),new _.h(n,a)}return this.evaluator.evaluate(this.getValue(e),t,function(a){return t.define(_.g.val(r.getVariable(e)),a),new _.h(n,a)})}},{key:"getHead",value:function(e){return _.d.cadr(e)}},{key:"getVariable",value:function(e){return this.getHead(e)}},{key:"getValue",value:function(e){return _.d.caddr(e)}},{key:"getFunctionName",value:function(e){return _.d.car(this.getHead(e))}},{key:"getLambdaParameters",value:function(e){return _.d.cdr(this.getHead(e))}},{key:"getLambdaBody",value:function(e){return _.d.cddr(e)}}]),e}(),C=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return b.isTaggedList(e,"if")}},{key:"evaluate",value:function(e,t,n){var r=this;return this.evaluator.evaluate(this.getIfPredicate(e),t,function(a){return _.b.isTrue(a)?r.evaluator.evaluate(r.getIfConsequent(e),t,n):r.evaluator.evaluate(r.getIfAlternative(e),t,n)})}},{key:"getIfPredicate",value:function(e){return _.d.cadr(e)}},{key:"getIfConsequent",value:function(e){return _.d.caddr(e)}},{key:"getIfAlternative",value:function(e){return _.d.isNil(_.d.cdddr(e))?_.d.Nil:_.d.cadddr(e)}}]),e}(),T=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(t){return e.isLet(t)||e.isLetStar(t)||e.isLetrec(t)}},{key:"evaluate",value:function(t,n,r){var a=this;if(e.isLet(t)){return function i(u,c){if(_.d.isNil(c))return a.evaluator.evaluateList(e.getBody(t),u,r);var o=_.d.car(c),s=_.d.car(o);return a.evaluator.evaluate(_.d.cadr(o),n,function(e){return u.define(_.g.val(s),e),i(u,_.d.cdr(c))})}(new g(n),e.getDefs(t))}if(e.isLetStar(t)){return function n(i,u){if(_.d.isNil(u))return a.evaluator.evaluateList(e.getBody(t),i,r);var c=_.d.car(u),o=_.d.car(c);return a.evaluator.evaluate(_.d.cadr(c),i,function(e){return(i=new g(i)).setOrDefine(_.g.val(o),e),n(i,_.d.cdr(u))})}(n,e.getDefs(t))}if(e.isLetrec(t)){for(var i=new g(n),u=e.getDefs(t);!_.d.isNil(u);){var c=_.d.car(u);i.define(_.g.val(_.d.car(c)),_.d.Nil),u=_.d.cdr(u)}return function n(i,u){if(_.d.isNil(u))return a.evaluator.evaluateList(e.getBody(t),i,r);var c=_.d.car(u),o=_.d.car(c);return a.evaluator.evaluate(_.d.cadr(c),i,function(e){return i.set(_.g.val(o),e),n(i,_.d.cdr(u))})}(i,e.getDefs(t))}throw"uknown let kind"}}],[{key:"isLet",value:function(e){return b.isTaggedList(e,"let")}},{key:"isLetStar",value:function(e){return b.isTaggedList(e,"let*")}},{key:"isLetrec",value:function(e){return b.isTaggedList(e,"letrec")}},{key:"getDefs",value:function(e){return _.d.cadr(e)}},{key:"getBody",value:function(e){return _.d.cddr(e)}}]),e}(),L=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return b.isTaggedList(e,"quote")}},{key:"evaluate",value:function(e,t,n){var r=_.d.cdr(e);return new _.h(n,r)}}]),e}(),x=function(){function e(){Object(v.a)(this,e)}return Object(f.a)(e,[{key:"matches",value:function(e){return _.f.matches(e)||_.b.matches(e)||_.e.matches(e)||_.d.isNil(e)}},{key:"evaluate",value:function(e,t,n){return new _.h(n,e)}}]),e}(),N=function(){function e(){Object(v.a)(this,e)}return Object(f.a)(e,[{key:"matches",value:function(e){return _.g.matches(e)}},{key:"evaluate",value:function(e,t,n){var r=t.get(_.g.val(e));return new _.h(n,r)}}]),e}(),D=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return b.isTaggedList(e,"set!")}},{key:"evaluate",value:function(e,t,n){var r=this;return this.evaluator.evaluate(this.getValue(e),t,function(a){return t.set(_.g.val(r.getVariable(e)),a),new _.h(n,a)})}},{key:"getVariable",value:function(e){return _.d.cadr(e)}},{key:"getValue",value:function(e){return _.d.caddr(e)}}]),e}(),B=function(){function e(){Object(v.a)(this,e),this.evaluator=void 0}return Object(f.a)(e,[{key:"evaluateString",value:function(e,t){var n=(new p.a).parse(e),r=new g(null);return r.define("cons",new _.d(new _.g("primitive"),new _.a(function(e){return new _.d(_.d.car(e),_.d.cadr(e))}))),r.define("null?",new _.d(new _.g("primitive"),new _.a(function(e){return _.b.fromBoolean(_.d.isNil(_.d.car(e)))}))),r.define("car",new _.d(new _.g("primitive"),new _.a(function(e){return _.d.car(_.d.car(e))}))),r.define("cadr",new _.d(new _.g("primitive"),new _.a(function(e){return _.d.cadr(_.d.car(e))}))),r.define("cdr",new _.d(new _.g("primitive"),new _.a(function(e){return _.d.cdr(_.d.car(e))}))),r.define("=",new _.d(new _.g("primitive"),new _.a(function(e){return _.b.fromBoolean(_.e.val(_.d.car(e))===_.e.val(_.d.cadr(e)))}))),r.define(">",new _.d(new _.g("primitive"),new _.a(function(e){return _.b.fromBoolean(_.e.val(_.d.car(e))>_.e.val(_.d.cadr(e)))}))),r.define("<",new _.d(new _.g("primitive"),new _.a(function(e){return _.b.fromBoolean(_.e.val(_.d.car(e))<_.e.val(_.d.cadr(e)))}))),r.define("*",new _.d(new _.g("primitive"),new _.a(function(e){return new _.e(_.e.val(_.d.car(e))*_.e.val(_.d.cadr(e)))}))),r.define("-",new _.d(new _.g("primitive"),new _.a(function(e){return new _.e(_.e.val(_.d.car(e))-_.e.val(_.d.cadr(e)))}))),r.define("+",new _.d(new _.g("primitive"),new _.a(function(e){return new _.e(_.e.val(_.d.car(e))+_.e.val(_.d.cadr(e)))}))),r.define("/",new _.d(new _.g("primitive"),new _.a(function(e){return new _.e(_.e.val(_.d.car(e))/_.e.val(_.d.cadr(e)))}))),r.define("min",new _.d(new _.g("primitive"),new _.a(function(e){return new _.e(Math.min(_.e.val(_.d.car(e)),_.e.val(_.d.cadr(e))))}))),r.define("max",new _.d(new _.g("primitive"),new _.a(function(e){return new _.e(Math.max(_.e.val(_.d.car(e)),_.e.val(_.d.cadr(e))))}))),r.define("abs",new _.d(new _.g("primitive"),new _.a(function(e){return new _.e(Math.abs(_.e.val(_.d.car(e))))}))),r.define("zero?",new _.d(new _.g("primitive"),new _.a(function(e){return _.b.fromBoolean(0===_.e.val(_.d.car(e)))}))),r.define("length",new _.d(new _.g("primitive"),new _.a(function(e){return _.d.lengthI(_.d.car(e))}))),r.define("not",new _.d(new _.g("primitive"),new _.a(function(e){return _.b.not(_.d.car(e))}))),r.define("and",new _.d(new _.g("primitive"),new _.a(function(e){return _.b.and(e)}))),r.define("or",new _.d(new _.g("primitive"),new _.a(function(e){return _.b.or(e)}))),r.define("display",new _.d(new _.g("primitive"),new _.a(function(e){for(;!_.d.isNil(e);)t(_.d.car(e).toDisplayString()),e=_.d.cdr(e);return _.d.Nil}))),r.define("newline",new _.d(new _.g("primitive"),new _.a(function(e){return t("\n"),_.d.Nil}))),this.evaluator=new b,this.evaluator.setEvaluators([new S(this.evaluator),new x,new N,new T(this.evaluator),new L(this.evaluator),new O(this.evaluator),new P(this.evaluator),new D(this.evaluator),new C(this.evaluator),new w(this.evaluator),new j(this.evaluator),new E(this.evaluator),new y(this.evaluator)]),this.evaluator.evaluateList(n,new g(r),function(e){return e})}},{key:"step",value:function(e,t){if(this.evaluator.setStepCount(t),_.c.matches(e))for(e=_.c.cast(e).val()();_.h.matches(e);)e=_.h.call(e);return _.c.matches(e)?e:null}}]),e}(),I=function(e){return a.a.createElement("div",{className:"sicp-editor-toolbar"},e.onRun&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onRun},"run"),e.onPause&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onPause},"pause"),e.onStop&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onStop},"stop"),e.onStep&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onStep},"step"),e.onContinue&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onContinue},"continue"),a.a.createElement(K,{samples:e.samples,onSampleSelected:e.onSampleSelected}))},K=function(e){var t=e.samples.map(function(e){var t=e.split("\n")[0].trim().replace(/^; /,"");return a.a.createElement("option",{key:e},t)});return a.a.createElement("select",{className:"sicp-editor-select-sample",onChange:function(t){e.onSampleSelected(t.target.selectedIndex)}},t)};var F=function(){function e(){var t=this;Object(v.a)(this,e),this.output=void 0,this.log=function(e){t.output+=e}}return Object(f.a)(e,[{key:"clear",value:function(){this.output=""}}]),e}(),M=function(e){if(!e.text)return a.a.createElement("div",null);var t=e.text.split("\n").map(function(e){return a.a.createElement("div",null,e)});return a.a.createElement("div",null,t)},R=function(e){var t=e.debuggerState;if("paused"!=t.kind||!_.c.matches(t.sv))return a.a.createElement("div",null);for(var n=t.sv,r=new k(n,n.env()),i=0,u=[],c=function(){for(var n=i,c=r.env();null!=c&&null==c.getSvSymbolProcedure();)c=c.getEnvParent();var o="sicp-stack-frame "+(n==t.currentStackFrameIndex?"sicp-stack-frame-current":"");u.push(a.a.createElement("div",{className:o,key:i,onClick:function(){return e.onStackFrameSelect(n)}},a.a.createElement("p",null,c?c.getSvSymbolProcedure().toString():"\xab not in procedure \xbb"))),r=r.parent(),i++};r;)c();return a.a.createElement("div",null,u)},A=function(e){var t=function(e){if("paused"!==e.kind)return null;for(var t=new k(e.sv,e.sv.env()),n=0;t&&n<e.currentStackFrameIndex;n++)t=t.parent();return t}(e.debuggerState);if(null==t)return a.a.createElement("div",null);for(var n=t.env(),r=[];n;)r.push(a.a.createElement("div",null,a.a.createElement("p",{className:"sicp-tree-node-title"},"Scope"),n.getNames().length>0&&a.a.createElement("div",{className:"sicp-tree-node-content"},n.getNames().map(function(e){return a.a.createElement("div",{key:e},a.a.createElement("div",{className:"sicp-variable-name"},e),a.a.createElement("div",{className:"sicp-variable-value"},n.get(e).toString()))})),0===n.getNames().length&&a.a.createElement("p",{className:"sicp-scope-empty"},"\xab empty \xbb"))),n=n.getEnvParent();return a.a.createElement("div",null,r)},W=function(){var e,t=a.a.useState([]),n=Object(d.a)(t,2),r=n[0],i=n[1],u=a.a.useState(0),o=Object(d.a)(u,2),v=o[0],f=o[1],h=a.a.useState(new F),k=Object(d.a)(h,1)[0],g=a.a.useState(new B),p=Object(d.a)(g,1)[0],b=a.a.useState({kind:"stopped"}),y=Object(d.a)(b,2),w=y[0],S=y[1],E=a.a.useRef();a.a.useEffect(function(){(function(){var e=Object(l.a)(s.a.mark(function e(){var t,n,r,a,i;return s.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:t=[],n=0,r=["samples/factorial.ms","samples/odd-or-even.ms","samples/counting-change.ms","samples/hanoi.ms","samples/n-queens.ms","samples/return-with-callcc.ms","samples/lazy-generator.ms","samples/yin-yang.ms"];case 3:if(!(n<r.length)){e.next=16;break}return a=r[n],e.next=7,fetch(a);case 7:return i=e.sent,e.t0=t,e.next=11,i.text();case 11:e.t1=e.sent,e.t0.push.call(e.t0,e.t1);case 13:n++,e.next=3;break;case 16:return e.abrupt("return",t);case 17:case"end":return e.stop()}},e)}));return function(){return e.apply(this,arguments)}})()().then(i)},[]),a.a.useEffect(function(){if("running"==w.kind||"step"===w.kind)try{var e=w.sv;if(null==e){var t,n=null===(t=E.current)||void 0===t?void 0:t.editor.getValue();n&&(j(),k.clear(),e=p.evaluateString(n,k.log))}else e=p.step(w.sv,"running"==w.kind?1e4:1);null==e?S({kind:"stopped"}):"running"==w.kind?S({kind:"running",sv:e}):_.c.matches(e)?S({kind:"paused",sv:e,currentStackFrameIndex:0}):S({kind:"stopped"})}catch(r){console.log(r),k.log("\nan error occured"),S({kind:"stopped"})}},[w]);var O,j=function(){S({kind:"stopped"})},P=[];"paused"==w.kind&&(P.push({startRow:w.sv.ilineStart,endRow:w.sv.ilineEnd,startCol:w.sv.icolStart,endCol:w.sv.icolEnd,className:"current-statement",type:"text"}),null===(O=E.current)||void 0===O||O.editor.gotoLine(w.sv.ilineStart));return a.a.createElement("div",{id:"editor-wrap"},a.a.createElement("div",{id:"editor"},a.a.createElement(I,{samples:r,onSampleSelected:function(e){j(),f(e)},onRun:"stopped"==w.kind?function(){S({kind:"running",sv:null})}:null,onStop:"paused"==w.kind||"running"==w.kind?j:null,onPause:"running"==w.kind?function(){"running"==w.kind&&_.c.matches(w.sv)&&S({kind:"paused",sv:w.sv,currentStackFrameIndex:0})}:null,onStep:"paused"==w.kind||"stopped"==w.kind?function(){"paused"==w.kind?S(Object(c.a)(Object(c.a)({},w),{},{kind:"step"})):"stopped"==w.kind&&S({kind:"step",sv:null})}:null,onContinue:"paused"==w.kind?function(){"paused"==w.kind&&S(Object(c.a)(Object(c.a)({},w),{},{kind:"running"}))}:null}),a.a.createElement(m.a,{ref:E,className:"editorWindow",mode:"typescript",theme:"tomorrow_night",name:"ace-editor",editorProps:{$blockScrolling:!1},value:null!==(e=r[v])&&void 0!==e?e:"",showGutter:!0,width:"auto",height:"auto",markers:P})),a.a.createElement("div",{id:"editor-bottom"},a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Output"),a.a.createElement("div",{id:"output-content",className:"sicp-box-tab-content"},a.a.createElement(M,{text:k.output}))),a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Stacktrace"),a.a.createElement("div",{id:"stacktrace-content",className:"sicp-box-tab-content"},a.a.createElement(R,{debuggerState:w,onStackFrameSelect:function(e){"paused"==w.kind&&S(Object(c.a)(Object(c.a)({},w),{},{kind:"paused",currentStackFrameIndex:e}))}}))),a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Variables"),a.a.createElement("div",{id:"variables-content",className:"sicp-box-tab-content"},a.a.createElement(A,{debuggerState:w})))))};var U=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{id:"header"},a.a.createElement("h2",null,"Mini scheme"),a.a.createElement("p",null,"by ",a.a.createElement("a",{href:"https://csokavar.hu"},"encse"))),a.a.createElement(W,null),a.a.createElement("div",{id:"footer"},"Copyright 2015, source is available on ",a.a.createElement("a",{href:"https://github.com/encse/sicp"},"GitHub")))},q=document.getElementById("root");u.a.render(a.a.createElement(U,null),q)}},[[21,1,2]]]);
//# sourceMappingURL=main.0abf554a.chunk.js.map