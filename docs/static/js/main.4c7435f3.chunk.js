(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(e,t,n){"use strict";n.d(t,"h",function(){return s}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"a",function(){return v}),n.d(t,"b",function(){return f}),n.d(t,"f",function(){return h}),n.d(t,"e",function(){return m}),n.d(t,"g",function(){return k});var r=n(5),a=n(4),i=n(2),u=n(3),c=function(){function e(){Object(i.a)(this,e),this.ilineStart=void 0,this.icolStart=void 0,this.ilineEnd=void 0,this.icolEnd=void 0}return Object(u.a)(e,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"withSourceInfo",value:function(e,t){return this.ilineStart=e.ilineStart,this.icolStart=e.icolStart,this.ilineEnd=t.ilineEnd,this.icolEnd=t.icolEnd,this}}]),e}(),o=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,null,[{key:"matches",value:function(e){return!d.matches(e)}}]),n}(c),s=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this)).cont=e,a.val=r,a}return Object(u.a)(n,null,[{key:"matches",value:function(e){return e instanceof n}},{key:"cast",value:function(e){if(!n.matches(e))throw"Breakpoint expected";return e}},{key:"call",value:function(e){return n.cast(e).cont(e.val)}}]),n}(c),l=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this))._val=e,a._env=r,a}return Object(u.a)(n,[{key:"env",value:function(){return this._env}},{key:"val",value:function(){return this._val}},{key:"toString",value:function(){return"T("+this._val.toString()+")"}},{key:"toDisplayString",value:function(){return""}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"cast",value:function(e){if(!n.matches(e))throw"Breakpoint expected";return e}}]),n}(c),d=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this))._car=e,a._cdr=r,a}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toStringI(function(e){return e.toDisplayString()})}},{key:"toString",value:function(){return this.toStringI(function(e){return e.toString()})}},{key:"toStringI",value:function(e){for(var t="(",r=!0,a=this;!n.isNil(a);){if(r||(t+=" "),r=!1,!n.matches(a)){t+=e(a);break}if(t+=e(n.car(a)),a=n.cdr(a),o.matches(a)){t+=" . "+e(a);break}}return t+=")"}}],[{key:"cons",value:function(e,t){return new n(e,t)}},{key:"listFromRvs",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.listFromRvArray(t)}},{key:"listFromRvArray",value:function(e){for(var t=n.Nil,r=e.length-1;r>=0;r--)t=new n(e[r],t);return t}},{key:"matches",value:function(e){return e instanceof n}},{key:"isNil",value:function(e){return e===n.Nil||n.matches(e)&&null===n.car(e)&&null===n.cdr(e)}},{key:"val",value:function(e){return v.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"Cons expected";return e}},{key:"car",value:function(e){return n.cast(e)._car}},{key:"cdr",value:function(e){return n.cast(e)._cdr}},{key:"setCar",value:function(e,t){return n.cast(e)._car=t,e}},{key:"setCdr",value:function(e,t){return n.cast(e)._cdr=t,e}},{key:"cadr",value:function(e){return this.car(this.cdr(e))}},{key:"cddr",value:function(e){return this.cdr(this.cdr(e))}},{key:"caddr",value:function(e){return this.car(this.cddr(e))}},{key:"cdddr",value:function(e){return this.cdr(this.cddr(e))}},{key:"cddddr",value:function(e){return this.cdr(this.cdddr(e))}},{key:"cadddr",value:function(e){return this.car(this.cdddr(e))}},{key:"caddddr",value:function(e){return this.car(this.cddddr(e))}},{key:"lengthI",value:function(e){for(var t=0;!this.isNil(e);)t++,e=this.cdr(e);return new m(t)}}]),n}(c);d.Nil=new d(null,null);var v=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return"[any]"}},{key:"toString",value:function(){return this._val.toString()}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"any expected";return e}}]),n}(c),f=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return this._val?"#t":"#f"}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"isTrue",value:function(e){return n.matches(e)&&n.val(e)}},{key:"isFalse",value:function(e){return n.matches(e)&&!n.val(e)}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"bool expected";return e}},{key:"not",value:function(e){return this.isTrue(e)?n.False:n.True}},{key:"and",value:function(e){for(;!d.isNil(e);){if(!this.isTrue(d.car(e)))return n.False;e=d.cdr(e)}return n.True}},{key:"or",value:function(e){for(;!d.isNil(e);){if(this.isTrue(d.car(e)))return n.True;e=d.cdr(e)}return n.False}},{key:"fromBoolean",value:function(e){return e?n.True:n.False}}]),n}(c);f.True=new f(!0),f.False=new f(!1);var h=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this._val}},{key:"toString",value:function(){return JSON.stringify(this._val)}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"string expected";return e}}]),n}(c),m=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return""+this._val}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"Number expected";return e}}]),n}(c),k=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return this._val}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw"Symbol expected";return e}}]),n}(c)},22:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Parser});var _Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_Sv__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),Parser=function(){function Parser(){Object(_Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,Parser),this.regexSymbol=/^[^\s()',]+/,this.regexNumber=/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/,this.regexString=/^"([^\\\"]+|\\.)*"/,this.regexWhiteSpace=/^\s*/,this.regexBoolean=/^#t|^#f/,this.regexComment=/^;.*/,this.tokens=void 0,this.itoken=0}return Object(_Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(Parser,[{key:"parse",value:function(e){this.tokens=this.getTokens(e).filter(function(e){return e.kind!==TokenKind.WhiteSpace&&e.kind!==TokenKind.Comment});var t=this.tokens.length?this.tokens[this.tokens.length-1]:null;this.tokens.push(t?new Token(TokenKind.EOF,"",t.ilineEnd,t.icolEnd+1):new Token(TokenKind.EOF,"",0,0)),this.itoken=0;for(var n=[];!this.accept(TokenKind.EOF);)n.push(this.parseExpression());return _Sv__WEBPACK_IMPORTED_MODULE_2__.d.listFromRvArray(n)}},{key:"nextToken",value:function(){this.itoken<this.tokens.length-1&&this.itoken++}},{key:"currentToken",value:function(){return this.tokens[this.itoken]}},{key:"accept",value:function(e){return this.currentToken().kind===e&&(this.nextToken(),!0)}},{key:"expect",value:function(e){if(this.accept(e))return!0;throw"expected "+e+" found "+this.currentToken().kind}},{key:"parseExpression",value:function parseExpression(){var token=this.currentToken();if(this.accept(TokenKind.Quote)){var svBody=this.parseExpression();return new _Sv__WEBPACK_IMPORTED_MODULE_2__.d(new _Sv__WEBPACK_IMPORTED_MODULE_2__.g("quote"),svBody).withSourceInfo(token,svBody)}if(this.accept(TokenKind.Symbol))return new _Sv__WEBPACK_IMPORTED_MODULE_2__.g(token.st).withSourceInfo(token,token);if(this.accept(TokenKind.BooleanLit))return _Sv__WEBPACK_IMPORTED_MODULE_2__.b.fromBoolean("#t"===token.st).withSourceInfo(token,token);if(this.accept(TokenKind.NumberLit))return new _Sv__WEBPACK_IMPORTED_MODULE_2__.e(eval(token.st)).withSourceInfo(token,token);if(this.accept(TokenKind.StringLit))return new _Sv__WEBPACK_IMPORTED_MODULE_2__.f(eval(token.st)).withSourceInfo(token,token);if(this.accept(TokenKind.LParen)){for(var tokenStart=token,exprs=[];!this.accept(TokenKind.RParen);){if(this.accept(TokenKind.EOF))throw"unexpected end of input";exprs.push(this.parseExpression())}var tokenEnd=this.tokens[this.itoken-1];return _Sv__WEBPACK_IMPORTED_MODULE_2__.d.listFromRvArray(exprs).withSourceInfo(tokenStart,tokenEnd)}throw"invalid token "+token}},{key:"getTokens",value:function(e){for(var t=[],n=0,r=0;e.length>0;){var a=e[0],i=void 0;if("("===a)i=new Token(TokenKind.LParen,a,n,r);else if(")"===a)i=new Token(TokenKind.RParen,a,n,r);else if("'"===a)i=new Token(TokenKind.Quote,a,n,r);else if(this.regexNumber.test(e))i=new Token(TokenKind.NumberLit,this.regexNumber.exec(e)[0],n,r);else if(this.regexString.test(e))i=new Token(TokenKind.StringLit,this.regexString.exec(e)[0],n,r);else if(this.regexBoolean.test(e))i=new Token(TokenKind.BooleanLit,this.regexBoolean.exec(e)[0],n,r);else if(this.regexComment.test(e))i=new Token(TokenKind.Comment,this.regexComment.exec(e)[0],n,r);else if(this.regexSymbol.test(e))i=new Token(TokenKind.Symbol,this.regexSymbol.exec(e)[0],n,r);else{if(!this.regexWhiteSpace.test(e))throw"invalid token at '"+e+"'";i=new Token(TokenKind.WhiteSpace,this.regexWhiteSpace.exec(e)[0],n,r)}if(t.push(i),0===i.st.length)throw"invalid token";e=e.substr(i.st.length),n=i.ilineEnd,r=i.icolEnd}return t}}]),Parser}(),TokenKind;!function(e){e[e.WhiteSpace=0]="WhiteSpace",e[e.BooleanLit=1]="BooleanLit",e[e.LParen=2]="LParen",e[e.RParen=3]="RParen",e[e.Symbol=4]="Symbol",e[e.NumberLit=5]="NumberLit",e[e.Quote=6]="Quote",e[e.StringLit=7]="StringLit",e[e.Comment=8]="Comment",e[e.EOF=9]="EOF"}(TokenKind||(TokenKind={}));var Token=Object(_Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(function e(t,n,r,a){Object(_Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,e),this.kind=t,this.st=n,this.ilineStart=r,this.icolStart=a,this.ilineEnd=void 0,this.icolEnd=void 0;var i=n.replace("\r","").split("\n");this.ilineEnd=this.ilineStart+i.length-1,this.ilineStart===this.ilineEnd?this.icolEnd=a+i[0].length:this.icolEnd=i[i.length-1].length})},23:function(e,t,n){e.exports=n(41)},28:function(e,t,n){},41:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(18),u=n.n(i),c=(n(28),n(6)),o=n(11),s=n.n(o),l=n(19),d=n(20),v=n(7),f=n(21),h=n.n(f),m=(n(38),n(40),n(2)),k=n(3),p=function(){function e(t,n){Object(m.a)(this,e),this._sv=t,this._env=n}return Object(k.a)(e,[{key:"sv",value:function(){return this._sv}},{key:"env",value:function(){return this._env}},{key:"parent",value:function(){return this._env.getParentStackFrame()}}]),e}(),g=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(m.a)(this,e),this.obj={},this.envParent=null,this.svSymbolProcedure=void 0,this.parentStackFrame=void 0,this.envParent=t,this.svSymbolProcedure=n,this.parentStackFrame=r}return Object(k.a)(e,[{key:"getNames",value:function(){var e=[];for(var t in this.obj)this.obj.hasOwnProperty(t)&&e.push(t);return e}},{key:"getEnvParent",value:function(){return this.envParent}},{key:"getSvSymbolProcedure",value:function(){return this.svSymbolProcedure}},{key:"getParentStackFrame",value:function(){return this.parentStackFrame?this.parentStackFrame:this.envParent?this.envParent.getParentStackFrame():null}},{key:"get",value:function(e){if(e in this.obj)return this.obj[e];if(null==this.envParent)throw"no binding for "+e;return this.envParent.get(e)}},{key:"set",value:function(e,t){if(e in this.obj)this.obj[e]=t;else{if(null==this.envParent)throw e+" is not declared";this.envParent.set(e,t)}}},{key:"define",value:function(e,t){if(e in this.obj)throw e+" is already defined";this.obj[e]=t}},{key:"setOrDefine",value:function(e,t){this.obj[e]=t}}]),e}(),_=n(22),b=n(0),y=function(){function e(){Object(m.a)(this,e),this.stepCount=1,this.step=0,this.evaluators=void 0}return Object(k.a)(e,[{key:"setEvaluators",value:function(e){this.evaluators=e}},{key:"setStepCount",value:function(e){this.stepCount=e,this.step=0}},{key:"matches",value:function(e){return!0}},{key:"evaluate",value:function(e,t,n){for(var r=this,a=0;a<this.evaluators.length;a++)if(this.evaluators[a].matches(e))return this.step++,this.step%this.stepCount==0?new b.c(function(){return r.evaluators[a].evaluate(e,t,n)},t).withSourceInfo(e,e):this.evaluators[a].evaluate(e,t,n);throw"cannot evaluate "+e.toString()}},{key:"evaluateList",value:function(e,t,n){var r=this,a=b.d.Nil;return function e(i){return b.d.isNil(i)?new b.h(n,a):r.evaluate(b.d.car(i),t,function(t){a=t;var n=b.d.cdr(i);return e(n)})}(e)}}],[{key:"isTaggedList",value:function(e,t){if(!b.d.matches(e))return!1;var n=b.d.car(e);return b.g.matches(n)&&b.g.val(n)===t}}]),e}(),w=function(){function e(t){Object(m.a)(this,e),this.evaluator=t}return Object(k.a)(e,[{key:"matches",value:function(e){return b.d.matches(e)}},{key:"evaluate",value:function(t,n,r){var a=this;return this.evaluator.evaluate(e.getOperator(t),n,function(i){if(!e.isPrimitiveProcedure(i)&&!e.isCompoundProcedure(i)&&!e.isContinuation(i))throw new Error("undefined procedure "+e.getOperator(t).toString());return a.evaluateArgs(e.getArguments(t),n,function(u){return e.evalCall(i,u,new p(t,n),r,a.evaluator)})})}},{key:"evaluateArgs",value:function(e,t,n){var r=this,a=new b.d(null,null);return function e(i,u){return b.d.isNil(u)?new b.h(n,a):r.evaluator.evaluate(b.d.car(u),t,function(t){return b.d.setCar(i,t),b.d.setCdr(i,new b.d(null,null)),e(b.d.cdr(i),b.d.cdr(u))})}(a,e)}}],[{key:"evalCall",value:function(e,t,n,r,a){if(this.isPrimitiveProcedure(e))return new b.h(r,this.getPrimitiveProcedureDelegate(e)(t));if(this.isContinuation(e)){var i=b.d.Nil;if(!b.d.isNil(t)){if(!b.d.isNil(b.d.cdr(t)))throw new Error("too many arguments");i=b.d.car(t)}return this.getContinuationFromCapturedContinuation(e)(i)}if(this.isCompoundProcedure(e)){for(var u=new g(this.getProcedureEnv(e),this.getProcedureSymbol(e),n),c=this.getProcedureParameters(e);!b.d.isNil(t)||!b.d.isNil(c);){if(b.d.isNil(t))throw new Error("not enough argument");if(b.d.isNil(c))throw new Error("too many arguments");var o=b.g.val(b.d.car(c)),s=b.d.car(t);u.define(o,s),c=b.d.cdr(c),t=b.d.cdr(t)}return a.evaluateList(this.getProcedureBody(e),u,r)}throw new Error("undefined procedure "+e.toString())}},{key:"isCompoundProcedure",value:function(e){return y.isTaggedList(e,"procedure")}},{key:"isPrimitiveProcedure",value:function(e){return y.isTaggedList(e,"primitive")}},{key:"isContinuation",value:function(e){return y.isTaggedList(e,"captured-continuation")}},{key:"getContinuationFromCapturedContinuation",value:function(e){return b.a.val(b.d.cdr(e))}},{key:"getProcedureSymbol",value:function(e){return b.g.cast(b.d.cadr(e))}},{key:"getProcedureParameters",value:function(e){return b.d.caddr(e)}},{key:"getProcedureBody",value:function(e){return b.d.cadddr(e)}},{key:"getProcedureEnv",value:function(e){return b.a.val(b.d.caddddr(e))}},{key:"getPrimitiveProcedureDelegate",value:function(e){return b.a.val(b.d.cdr(e))}},{key:"getOperator",value:function(e){return b.d.car(e)}},{key:"getArguments",value:function(e){return b.d.cdr(e)}}]),e}(),S=function(){function e(t){Object(m.a)(this,e),this.evaluator=t}return Object(k.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"begin")}},{key:"evaluate",value:function(e,t,n){return this.evaluator.evaluateList(this.getBeginActions(e),t,n)}},{key:"getBeginActions",value:function(e){return b.d.cdr(e)}}]),e}(),E=function(){function e(t){Object(m.a)(this,e),this.evaluator=t}return Object(k.a)(e,[{key:"matches",value:function(e){return b.c.matches(e)}},{key:"evaluate",value:function(e,t,n){return new b.h(n,b.c.cast(e).val()())}}]),e}(),O=function(){function e(t){Object(m.a)(this,e),this.evaluator=t}return Object(k.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"call-with-current-continuation")}},{key:"evaluate",value:function(t,n,r){var a=this;return this.evaluator.evaluate(this.getLambda(t),n,function(i){var u=b.d.listFromRvs(e.createCcProcedure(r));return w.evalCall(i,u,new p(t,n),r,a.evaluator)})}},{key:"getLambda",value:function(e){return b.d.cadr(e)}}],[{key:"createCcProcedure",value:function(e){return new b.d(new b.g("captured-continuation"),new b.a(e))}}]),e}(),j=function(){function e(t){Object(m.a)(this,e),this.evaluator=t}return Object(k.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"cond")}},{key:"getCondClauses",value:function(e){return b.d.cdr(e)}},{key:"isCondElseClause",value:function(e){return y.isTaggedList(e,"else")}},{key:"getCondPredicate",value:function(e){return b.d.car(e)}},{key:"getCondActions",value:function(e){return b.d.cdr(e)}},{key:"evaluate",value:function(e,t,n){var r=this;return function e(a){if(b.d.isNil(a))return new b.h(n,a);var i=b.d.car(a);return r.isCondElseClause(i)?r.evaluator.evaluateList(r.getCondActions(i),t,n):r.evaluator.evaluate(b.d.car(i),t,function(u){if(b.b.isTrue(u))return r.evaluator.evaluateList(r.getCondActions(i),t,n);var c=b.d.cdr(a);return e(c)})}(this.getCondClauses(e))}}]),e}(),P=function(){function e(t){Object(m.a)(this,e),this.evaluator=t}return Object(k.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"lambda")}},{key:"evaluate",value:function(t,n,r){var a=e.createCompoundProcedure(new b.g("lambda"),e.getLambdaParameters(t),e.getLambdaBody(t),n);return new b.h(r,a)}}],[{key:"createCompoundProcedure",value:function(e,t,n,r){return b.d.listFromRvs(new b.g("procedure"),e,t,n,new b.a(r))}},{key:"getLambdaParameters",value:function(e){return b.d.cadr(e)}},{key:"getLambdaBody",value:function(e){return b.d.cddr(e)}}]),e}(),C=function(){function e(t){Object(m.a)(this,e),this.evaluator=t}return Object(k.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"define")}},{key:"evaluate",value:function(e,t,n){var r=this;if(b.d.matches(this.getHead(e))){var a=P.createCompoundProcedure(this.getFunctionName(e),this.getLambdaParameters(e),this.getLambdaBody(e),t);return t.define(b.g.val(this.getFunctionName(e)),a),new b.h(n,a)}return this.evaluator.evaluate(this.getValue(e),t,function(a){return t.define(b.g.val(r.getVariable(e)),a),new b.h(n,a)})}},{key:"getHead",value:function(e){return b.d.cadr(e)}},{key:"getVariable",value:function(e){return this.getHead(e)}},{key:"getValue",value:function(e){return b.d.caddr(e)}},{key:"getFunctionName",value:function(e){return b.d.car(this.getHead(e))}},{key:"getLambdaParameters",value:function(e){return b.d.cdr(this.getHead(e))}},{key:"getLambdaBody",value:function(e){return b.d.cddr(e)}}]),e}(),T=function(){function e(t){Object(m.a)(this,e),this.evaluator=t}return Object(k.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"if")}},{key:"evaluate",value:function(e,t,n){var r=this;return this.evaluator.evaluate(this.getIfPredicate(e),t,function(a){return b.b.isTrue(a)?r.evaluator.evaluate(r.getIfConsequent(e),t,n):r.evaluator.evaluate(r.getIfAlternative(e),t,n)})}},{key:"getIfPredicate",value:function(e){return b.d.cadr(e)}},{key:"getIfConsequent",value:function(e){return b.d.caddr(e)}},{key:"getIfAlternative",value:function(e){return b.d.isNil(b.d.cdddr(e))?b.d.Nil:b.d.cadddr(e)}}]),e}(),x=function(){function e(t){Object(m.a)(this,e),this.evaluator=t}return Object(k.a)(e,[{key:"matches",value:function(t){return e.isLet(t)||e.isLetStar(t)||e.isLetrec(t)}},{key:"evaluate",value:function(t,n,r){var a=this;if(e.isLet(t)){return function i(u,c){if(b.d.isNil(c))return a.evaluator.evaluateList(e.getBody(t),u,r);var o=b.d.car(c),s=b.d.car(o);return a.evaluator.evaluate(b.d.cadr(o),n,function(e){return u.define(b.g.val(s),e),i(u,b.d.cdr(c))})}(new g(n),e.getDefs(t))}if(e.isLetStar(t)){return function n(i,u){if(b.d.isNil(u))return a.evaluator.evaluateList(e.getBody(t),i,r);var c=b.d.car(u),o=b.d.car(c);return a.evaluator.evaluate(b.d.cadr(c),i,function(e){return(i=new g(i)).setOrDefine(b.g.val(o),e),n(i,b.d.cdr(u))})}(n,e.getDefs(t))}if(e.isLetrec(t)){for(var i=new g(n),u=e.getDefs(t);!b.d.isNil(u);){var c=b.d.car(u);i.define(b.g.val(b.d.car(c)),b.d.Nil),u=b.d.cdr(u)}return function n(i,u){if(b.d.isNil(u))return a.evaluator.evaluateList(e.getBody(t),i,r);var c=b.d.car(u),o=b.d.car(c);return a.evaluator.evaluate(b.d.cadr(c),i,function(e){return i.set(b.g.val(o),e),n(i,b.d.cdr(u))})}(i,e.getDefs(t))}throw"uknown let kind"}}],[{key:"isLet",value:function(e){return y.isTaggedList(e,"let")}},{key:"isLetStar",value:function(e){return y.isTaggedList(e,"let*")}},{key:"isLetrec",value:function(e){return y.isTaggedList(e,"letrec")}},{key:"getDefs",value:function(e){return b.d.cadr(e)}},{key:"getBody",value:function(e){return b.d.cddr(e)}}]),e}(),L=function(){function e(t){Object(m.a)(this,e),this.evaluator=t}return Object(k.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"quote")}},{key:"evaluate",value:function(e,t,n){var r=b.d.cdr(e);return new b.h(n,r)}}]),e}(),N=function(){function e(){Object(m.a)(this,e)}return Object(k.a)(e,[{key:"matches",value:function(e){return b.f.matches(e)||b.b.matches(e)||b.e.matches(e)||b.d.isNil(e)}},{key:"evaluate",value:function(e,t,n){return new b.h(n,e)}}]),e}(),D=function(){function e(){Object(m.a)(this,e)}return Object(k.a)(e,[{key:"matches",value:function(e){return b.g.matches(e)}},{key:"evaluate",value:function(e,t,n){var r=t.get(b.g.val(e));return new b.h(n,r)}}]),e}(),B=function(){function e(t){Object(m.a)(this,e),this.evaluator=t}return Object(k.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"set!")}},{key:"evaluate",value:function(e,t,n){var r=this;return this.evaluator.evaluate(this.getValue(e),t,function(a){return t.set(b.g.val(r.getVariable(e)),a),new b.h(n,a)})}},{key:"getVariable",value:function(e){return b.d.cadr(e)}},{key:"getValue",value:function(e){return b.d.caddr(e)}}]),e}(),I=function(){function e(){Object(m.a)(this,e),this.evaluator=void 0}return Object(k.a)(e,[{key:"evaluateString",value:function(e,t){var n=(new _.a).parse(e),r=new g(null);return r.define("cons",new b.d(new b.g("primitive"),new b.a(function(e){return new b.d(b.d.car(e),b.d.cadr(e))}))),r.define("null?",new b.d(new b.g("primitive"),new b.a(function(e){return b.b.fromBoolean(b.d.isNil(b.d.car(e)))}))),r.define("car",new b.d(new b.g("primitive"),new b.a(function(e){return b.d.car(b.d.car(e))}))),r.define("cadr",new b.d(new b.g("primitive"),new b.a(function(e){return b.d.cadr(b.d.car(e))}))),r.define("cdr",new b.d(new b.g("primitive"),new b.a(function(e){return b.d.cdr(b.d.car(e))}))),r.define("=",new b.d(new b.g("primitive"),new b.a(function(e){return b.b.fromBoolean(b.e.val(b.d.car(e))===b.e.val(b.d.cadr(e)))}))),r.define(">",new b.d(new b.g("primitive"),new b.a(function(e){return b.b.fromBoolean(b.e.val(b.d.car(e))>b.e.val(b.d.cadr(e)))}))),r.define("<",new b.d(new b.g("primitive"),new b.a(function(e){return b.b.fromBoolean(b.e.val(b.d.car(e))<b.e.val(b.d.cadr(e)))}))),r.define("*",new b.d(new b.g("primitive"),new b.a(function(e){return new b.e(b.e.val(b.d.car(e))*b.e.val(b.d.cadr(e)))}))),r.define("-",new b.d(new b.g("primitive"),new b.a(function(e){return new b.e(b.e.val(b.d.car(e))-b.e.val(b.d.cadr(e)))}))),r.define("+",new b.d(new b.g("primitive"),new b.a(function(e){return new b.e(b.e.val(b.d.car(e))+b.e.val(b.d.cadr(e)))}))),r.define("/",new b.d(new b.g("primitive"),new b.a(function(e){return new b.e(b.e.val(b.d.car(e))/b.e.val(b.d.cadr(e)))}))),r.define("min",new b.d(new b.g("primitive"),new b.a(function(e){return new b.e(Math.min(b.e.val(b.d.car(e)),b.e.val(b.d.cadr(e))))}))),r.define("max",new b.d(new b.g("primitive"),new b.a(function(e){return new b.e(Math.max(b.e.val(b.d.car(e)),b.e.val(b.d.cadr(e))))}))),r.define("abs",new b.d(new b.g("primitive"),new b.a(function(e){return new b.e(Math.abs(b.e.val(b.d.car(e))))}))),r.define("zero?",new b.d(new b.g("primitive"),new b.a(function(e){return b.b.fromBoolean(0===b.e.val(b.d.car(e)))}))),r.define("length",new b.d(new b.g("primitive"),new b.a(function(e){return b.d.lengthI(b.d.car(e))}))),r.define("not",new b.d(new b.g("primitive"),new b.a(function(e){return b.b.not(b.d.car(e))}))),r.define("and",new b.d(new b.g("primitive"),new b.a(function(e){return b.b.and(e)}))),r.define("or",new b.d(new b.g("primitive"),new b.a(function(e){return b.b.or(e)}))),r.define("display",new b.d(new b.g("primitive"),new b.a(function(e){for(;!b.d.isNil(e);)t(b.d.car(e).toDisplayString()),e=b.d.cdr(e);return b.d.Nil}))),r.define("newline",new b.d(new b.g("primitive"),new b.a(function(e){return t("\n"),b.d.Nil}))),this.evaluator=new y,this.evaluator.setEvaluators([new E(this.evaluator),new N,new D,new x(this.evaluator),new L(this.evaluator),new j(this.evaluator),new C(this.evaluator),new B(this.evaluator),new T(this.evaluator),new S(this.evaluator),new P(this.evaluator),new O(this.evaluator),new w(this.evaluator)]),this.evaluator.evaluateList(n,new g(r),function(e){return e})}},{key:"step",value:function(e,t){if(this.evaluator.setStepCount(t),b.c.matches(e))for(e=b.c.cast(e).val()();b.h.matches(e);)e=b.h.call(e);return b.c.matches(e)?e:null}}]),e}(),K=n(5),F=n(4),M=function(e){var t=e.samples.map(function(e){var t=e.split("\n")[0].trim().replace(/^; /,"");return a.a.createElement("option",{key:e},t)});return a.a.createElement("select",{className:"sicp-editor-select-sample",onChange:function(t){e.onSampleSelected(t.target.selectedIndex)}},t)},R=function(e){Object(K.a)(n,e);var t=Object(F.a)(n);function n(){var e;Object(m.a)(this,n);for(var r=arguments.length,a=new Array(r),i=0;i<r;i++)a[i]=arguments[i];return(e=t.call.apply(t,[this].concat(a))).onRun=function(){e.props.onRun()},e.onPause=function(){e.props.onPause()},e.onStop=function(){e.props.onStop()},e.onStep=function(){e.props.onStep()},e.onContinue=function(){e.props.onContinue()},e.onSampleSelected=function(t){e.props.onSampleSelected(t)},e}return Object(k.a)(n,[{key:"render",value:function(){return a.a.createElement("div",{className:"sicp-editor-toolbar"},this.props.onRun&&a.a.createElement("button",{className:"sicp-editor-button",onClick:this.onRun},"run"),this.props.onPause&&a.a.createElement("button",{className:"sicp-editor-button",onClick:this.onPause},"pause"),this.props.onStop&&a.a.createElement("button",{className:"sicp-editor-button",onClick:this.onStop},"stop"),this.props.onStep&&a.a.createElement("button",{className:"sicp-editor-button",onClick:this.onStep},"step"),this.props.onContinue&&a.a.createElement("button",{className:"sicp-editor-button",onClick:this.onContinue},"continue"),a.a.createElement(M,{samples:this.props.samples,onSampleSelected:this.onSampleSelected}))}}]),n}(a.a.PureComponent);var A=function(e){var t=function(e){if("paused"!==e.kind)return null;for(var t=new p(e.sv,e.sv.env()),n=0;t&&n<e.currentStackFrameIndex;n++)t=t.parent();return t}(e.debuggerState);if(null==t)return a.a.createElement("div",null);for(var n=t.env(),r=[];n;)r.push(a.a.createElement("div",null,a.a.createElement("p",{className:"sicp-tree-node-title"},"Scope"),n.getNames().length>0&&a.a.createElement("div",{className:"sicp-tree-node-content"},n.getNames().map(function(e){return a.a.createElement("div",{key:e},a.a.createElement("div",{className:"sicp-variable-name"},e),a.a.createElement("div",{className:"sicp-variable-value"},n.get(e).toDisplayString()))})),0===n.getNames().length&&a.a.createElement("p",{className:"sicp-scope-empty"},"\xab empty \xbb"))),n=n.getEnvParent();return a.a.createElement("div",null,r)},W=function(e){var t=e.debuggerState;if("paused"!==t.kind||!b.c.matches(t.sv))return a.a.createElement("div",null);for(var n=t.sv,r=new p(n,n.env()),i=0,u=[],c=function(){for(var n=i,c=r.env();null!=c&&null==c.getSvSymbolProcedure();)c=c.getEnvParent();var o="sicp-stack-frame "+(n==t.currentStackFrameIndex?"sicp-stack-frame-current":"");u.push(a.a.createElement("div",{className:o,key:i,onClick:function(){return e.onStackFrameSelect(n)}},a.a.createElement("p",null,c?c.getSvSymbolProcedure().toString():"\xab not in procedure \xbb"))),r=r.parent(),i++};r;)c();return a.a.createElement("div",null,u)},U=function(){function e(){var t=this;Object(m.a)(this,e),this.output=void 0,this.log=function(e){t.output+=e}}return Object(k.a)(e,[{key:"clear",value:function(){this.output=""}}]),e}(),q=function(e){if(!e.text)return a.a.createElement("div",null);var t=e.text.split("\n").map(function(e){return a.a.createElement("div",null,e)});return a.a.createElement("div",null,t)},V=function(e){var t,n=a.a.useState([]),r=Object(v.a)(n,2),i=r[0],u=r[1],o=a.a.useState(0),f=Object(v.a)(o,2),m=f[0],k=f[1],p=a.a.useState(new U),g=Object(v.a)(p,1)[0],_=a.a.useState(new I),y=Object(v.a)(_,1)[0],w=a.a.useState({kind:"stopped"}),S=Object(v.a)(w,2),E=S[0],O=S[1],j=a.a.useRef();a.a.useEffect(function(){(function(){var t=Object(d.a)(s.a.mark(function t(){var n,r,a,i,u;return s.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=Object(l.a)(e.samples),t.prev=2,r.s();case 4:if((a=r.n()).done){t.next=16;break}return i=a.value,t.next=8,fetch(i);case 8:return u=t.sent,t.t0=n,t.next=12,u.text();case 12:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 14:t.next=4;break;case 16:t.next=21;break;case 18:t.prev=18,t.t2=t.catch(2),r.e(t.t2);case 21:return t.prev=21,r.f(),t.finish(21);case 24:return t.abrupt("return",n);case 25:case"end":return t.stop()}},t,null,[[2,18,21,24]])}));return function(){return t.apply(this,arguments)}})()().then(u)},e.samples),a.a.useEffect(function(){if("running"==E.kind||"step"===E.kind)try{var e=E.sv;if(null==e){var t,n=null===(t=j.current)||void 0===t?void 0:t.editor.getValue();n&&(C(),g.clear(),e=y.evaluateString(n,g.log))}else e=y.step(E.sv,"running"==E.kind?1e4:1);null==e?O({kind:"stopped"}):"running"==E.kind?O({kind:"running",sv:e}):b.c.matches(e)?O({kind:"paused",sv:e,currentStackFrameIndex:0}):O({kind:"stopped"})}catch(r){console.log(r),g.log("\nan error occured"),O({kind:"stopped"})}},[E]);var P,C=function(){O({kind:"stopped"})},T=[];"paused"==E.kind&&(T.push({startRow:E.sv.ilineStart,endRow:E.sv.ilineEnd,startCol:E.sv.icolStart,endCol:E.sv.icolEnd,className:"current-statement",type:"text"}),null===(P=j.current)||void 0===P||P.editor.gotoLine(E.sv.ilineStart));return a.a.createElement("div",{id:"editor-wrap"},a.a.createElement("div",{id:"editor"},a.a.createElement(R,{samples:i,onSampleSelected:function(e){C(),k(e)},onRun:"stopped"==E.kind?function(){O({kind:"running",sv:null})}:null,onStop:"paused"==E.kind||"running"==E.kind?C:null,onPause:"running"==E.kind?function(){"running"==E.kind&&b.c.matches(E.sv)&&O({kind:"paused",sv:E.sv,currentStackFrameIndex:0})}:null,onStep:"paused"==E.kind||"stopped"==E.kind?function(){"paused"==E.kind?O(Object(c.a)(Object(c.a)({},E),{},{kind:"step"})):"stopped"==E.kind&&O({kind:"step",sv:null})}:null,onContinue:"paused"==E.kind?function(){"paused"==E.kind&&O(Object(c.a)(Object(c.a)({},E),{},{kind:"running"}))}:null}),a.a.createElement(h.a,{ref:j,className:"editorWindow",mode:"typescript",theme:"tomorrow_night",name:"ace-editor",editorProps:{$blockScrolling:!1},value:null!==(t=i[m])&&void 0!==t?t:"",showGutter:!0,width:"auto",height:"auto",markers:T})),a.a.createElement("div",{id:"editor-bottom"},a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Output"),a.a.createElement("div",{id:"output-content",className:"sicp-box-tab-content"},a.a.createElement(q,{text:g.output}))),a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Stacktrace"),a.a.createElement("div",{id:"stacktrace-content",className:"sicp-box-tab-content"},a.a.createElement(W,{debuggerState:E,onStackFrameSelect:function(e){"paused"==E.kind&&O(Object(c.a)(Object(c.a)({},E),{},{kind:"paused",currentStackFrameIndex:e}))}}))),a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Variables"),a.a.createElement("div",{id:"variables-content",className:"sicp-box-tab-content"},a.a.createElement(A,{debuggerState:E})))))},H=["samples/factorial.ms","samples/odd-or-even.ms","samples/counting-change.ms","samples/hanoi.ms","samples/n-queens.ms","samples/return-with-callcc.ms","samples/lazy-generator.ms","samples/yin-yang.ms"];var Q=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{id:"header"},a.a.createElement("h2",null,"Mini scheme"),a.a.createElement("p",null,"by ",a.a.createElement("a",{href:"https://csokavar.hu"},"encse"))),a.a.createElement(V,{samples:H}),a.a.createElement("div",{id:"footer"},"Copyright 2015, source is available on ",a.a.createElement("a",{href:"https://github.com/encse/sicp"},"GitHub")))},J=document.getElementById("root");u.a.render(a.a.createElement(Q,null),J)}},[[23,1,2]]]);
//# sourceMappingURL=main.4c7435f3.chunk.js.map