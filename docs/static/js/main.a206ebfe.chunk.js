(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(e,t,n){"use strict";n.d(t,"h",function(){return s}),n.d(t,"c",function(){return l}),n.d(t,"d",function(){return d}),n.d(t,"a",function(){return v}),n.d(t,"b",function(){return f}),n.d(t,"f",function(){return h}),n.d(t,"e",function(){return m}),n.d(t,"g",function(){return g});var r=n(5),a=n(4),i=n(2),u=n(3),c=function(){function e(){Object(i.a)(this,e),this.ilineStart=void 0,this.icolStart=void 0,this.ilineEnd=void 0,this.icolEnd=void 0}return Object(u.a)(e,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"withSourceInfo",value:function(e,t){return this.ilineStart=e.ilineStart,this.icolStart=e.icolStart,this.ilineEnd=t.ilineEnd,this.icolEnd=t.icolEnd,this}}]),e}(),o=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,null,[{key:"matches",value:function(e){return!d.matches(e)}}]),n}(c),s=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this)).cont=e,a.val=r,a}return Object(u.a)(n,null,[{key:"matches",value:function(e){return e instanceof n}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("Breakpoint expected");return e}},{key:"call",value:function(e){return n.cast(e).cont(e.val)}}]),n}(c),l=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this))._val=e,a._env=r,a}return Object(u.a)(n,[{key:"env",value:function(){return this._env}},{key:"val",value:function(){return this._val}},{key:"toString",value:function(){return"T("+this._val.toString()+")"}},{key:"toDisplayString",value:function(){return""}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("Breakpoint expected");return e}}]),n}(c),d=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this))._car=e,a._cdr=r,a}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toStringI(function(e){return e.toDisplayString()})}},{key:"toString",value:function(){return this.toStringI(function(e){return e.toString()})}},{key:"toStringI",value:function(e){for(var t="(",r=!0,a=this;!n.isNil(a);){if(r||(t+=" "),r=!1,!n.matches(a)){t+=e(a);break}if(t+=e(n.car(a)),a=n.cdr(a),o.matches(a)){t+=" . "+e(a);break}}return t+=")"}}],[{key:"cons",value:function(e,t){return new n(e,t)}},{key:"listFromRvs",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.listFromRvArray(t)}},{key:"listFromRvArray",value:function(e){for(var t=n.Nil,r=e.length-1;r>=0;r--)t=new n(e[r],t);return t}},{key:"matches",value:function(e){return e instanceof n}},{key:"isNil",value:function(e){return e===n.Nil||n.matches(e)&&null===n.car(e)&&null===n.cdr(e)}},{key:"val",value:function(e){return v.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("Cons expected");return e}},{key:"car",value:function(e){return n.cast(e)._car}},{key:"cdr",value:function(e){return n.cast(e)._cdr}},{key:"setCar",value:function(e,t){return n.cast(e)._car=t,e}},{key:"setCdr",value:function(e,t){return n.cast(e)._cdr=t,e}},{key:"cadr",value:function(e){return this.car(this.cdr(e))}},{key:"cddr",value:function(e){return this.cdr(this.cdr(e))}},{key:"caddr",value:function(e){return this.car(this.cddr(e))}},{key:"cdddr",value:function(e){return this.cdr(this.cddr(e))}},{key:"cddddr",value:function(e){return this.cdr(this.cdddr(e))}},{key:"cadddr",value:function(e){return this.car(this.cdddr(e))}},{key:"caddddr",value:function(e){return this.car(this.cddddr(e))}},{key:"lengthI",value:function(e){for(var t=0;!this.isNil(e);)t++,e=this.cdr(e);return new m(t)}}]),n}(c);d.Nil=new d(null,null);var v=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return"builtin"}},{key:"toString",value:function(){return this._val.toString()}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("any expected");return e}}]),n}(c),f=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return this._val?"#t":"#f"}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"isTrue",value:function(e){return n.matches(e)&&n.val(e)}},{key:"isFalse",value:function(e){return n.matches(e)&&!n.val(e)}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("bool expected");return e}},{key:"not",value:function(e){return this.isTrue(e)?n.False:n.True}},{key:"and",value:function(e){for(;!d.isNil(e);){if(!this.isTrue(d.car(e)))return n.False;e=d.cdr(e)}return n.True}},{key:"or",value:function(e){for(;!d.isNil(e);){if(this.isTrue(d.car(e)))return n.True;e=d.cdr(e)}return n.False}},{key:"fromBoolean",value:function(e){return e?n.True:n.False}}]),n}(c);f.True=new f(!0),f.False=new f(!1);var h=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this._val}},{key:"toString",value:function(){return JSON.stringify(this._val)}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("string expected");return e}}]),n}(c),m=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return""+this._val}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("Number expected");return e}}]),n}(c),g=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return this._val}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("Symbol expected");return e}}]),n}(c)},19:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Parser});var _Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_sv__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),TokenKind;!function(e){e[e.WhiteSpace=0]="WhiteSpace",e[e.BooleanLit=1]="BooleanLit",e[e.LParen=2]="LParen",e[e.RParen=3]="RParen",e[e.Symbol=4]="Symbol",e[e.NumberLit=5]="NumberLit",e[e.Quote=6]="Quote",e[e.StringLit=7]="StringLit",e[e.Comment=8]="Comment",e[e.EOF=9]="EOF"}(TokenKind||(TokenKind={}));var Parser=function(){function Parser(){Object(_Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,Parser),this.regexSymbol=/^[^\s()',]+/,this.regexNumber=/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/,this.regexString=/^"([^\\"]+|\\.)*"/,this.regexWhiteSpace=/^\s*/,this.regexBoolean=/^#t|^#f/,this.regexComment=/^;.*/,this.tokens=void 0,this.itoken=0}return Object(_Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(Parser,[{key:"parse",value:function(e){this.tokens=this.getTokens(e).filter(function(e){return e.kind!==TokenKind.WhiteSpace&&e.kind!==TokenKind.Comment});var t=this.tokens.length?this.tokens[this.tokens.length-1]:null;this.tokens.push(t?new Token(TokenKind.EOF,"",t.ilineEnd,t.icolEnd+1):new Token(TokenKind.EOF,"",0,0)),this.itoken=0;for(var n=[];!this.accept(TokenKind.EOF);)n.push(this.parseExpression());return _sv__WEBPACK_IMPORTED_MODULE_2__.d.listFromRvArray(n)}},{key:"nextToken",value:function(){this.itoken<this.tokens.length-1&&this.itoken++}},{key:"currentToken",value:function(){return this.tokens[this.itoken]}},{key:"accept",value:function(e){return this.currentToken().kind===e&&(this.nextToken(),!0)}},{key:"expect",value:function(e){if(this.accept(e))return!0;throw new Error("expected "+e+" found "+this.currentToken().kind)}},{key:"parseExpression",value:function parseExpression(){var token=this.currentToken();if(this.accept(TokenKind.Quote)){var svBody=this.parseExpression();return new _sv__WEBPACK_IMPORTED_MODULE_2__.d(new _sv__WEBPACK_IMPORTED_MODULE_2__.g("quote"),svBody).withSourceInfo(token,svBody)}if(this.accept(TokenKind.Symbol))return new _sv__WEBPACK_IMPORTED_MODULE_2__.g(token.st).withSourceInfo(token,token);if(this.accept(TokenKind.BooleanLit))return _sv__WEBPACK_IMPORTED_MODULE_2__.b.fromBoolean("#t"===token.st).withSourceInfo(token,token);if(this.accept(TokenKind.NumberLit))return new _sv__WEBPACK_IMPORTED_MODULE_2__.e(eval(token.st)).withSourceInfo(token,token);if(this.accept(TokenKind.StringLit))return new _sv__WEBPACK_IMPORTED_MODULE_2__.f(eval(token.st)).withSourceInfo(token,token);if(this.accept(TokenKind.LParen)){for(var tokenStart=token,exprs=[];!this.accept(TokenKind.RParen);){if(this.accept(TokenKind.EOF))throw new Error("unexpected end of input");exprs.push(this.parseExpression())}var tokenEnd=this.tokens[this.itoken-1];return _sv__WEBPACK_IMPORTED_MODULE_2__.d.listFromRvArray(exprs).withSourceInfo(tokenStart,tokenEnd)}throw new Error("invalid token "+token)}},{key:"getTokens",value:function(e){for(var t=[],n=0,r=0;e.length>0;){var a=e[0],i=void 0;if("("===a)i=new Token(TokenKind.LParen,a,n,r);else if(")"===a)i=new Token(TokenKind.RParen,a,n,r);else if("'"===a)i=new Token(TokenKind.Quote,a,n,r);else if(this.regexNumber.test(e))i=new Token(TokenKind.NumberLit,this.regexNumber.exec(e)[0],n,r);else if(this.regexString.test(e))i=new Token(TokenKind.StringLit,this.regexString.exec(e)[0],n,r);else if(this.regexBoolean.test(e))i=new Token(TokenKind.BooleanLit,this.regexBoolean.exec(e)[0],n,r);else if(this.regexComment.test(e))i=new Token(TokenKind.Comment,this.regexComment.exec(e)[0],n,r);else if(this.regexSymbol.test(e))i=new Token(TokenKind.Symbol,this.regexSymbol.exec(e)[0],n,r);else{if(!this.regexWhiteSpace.test(e))throw new Error("invalid token at '"+e+"'");i=new Token(TokenKind.WhiteSpace,this.regexWhiteSpace.exec(e)[0],n,r)}if(t.push(i),0===i.st.length)throw new Error("invalid token");e=e.substr(i.st.length),n=i.ilineEnd,r=i.icolEnd}return t}}]),Parser}(),Token=Object(_Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(function e(t,n,r,a){Object(_Users_encse_projects_mini_scheme_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,e),this.kind=t,this.st=n,this.ilineStart=r,this.icolStart=a,this.ilineEnd=void 0,this.icolEnd=void 0;var i=n.replace("\r","").split("\n");this.ilineEnd=this.ilineStart+i.length-1,this.ilineStart===this.ilineEnd?this.icolEnd=a+i[0].length:this.icolEnd=i[i.length-1].length})},21:function(e,t,n){e.exports=n(39)},26:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(16),u=n.n(i),c=(n(26),n(9)),o=n.n(c),s=n(20),l=n(17),d=n(6),v=n(2),f=n(3),h=n(5),m=n(4),g=n(18),k=n.n(g),p=(n(36),n(38),function(){function e(t,n){Object(v.a)(this,e),this._sv=t,this._env=n}return Object(f.a)(e,[{key:"sv",value:function(){return this._sv}},{key:"env",value:function(){return this._env}},{key:"parent",value:function(){return this._env.getParentStackFrame()}}]),e}()),_=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(v.a)(this,e),this.obj={},this.envParent=null,this.svSymbolProcedure=void 0,this.parentStackFrame=void 0,this.envParent=t,this.svSymbolProcedure=n,this.parentStackFrame=r}return Object(f.a)(e,[{key:"getNames",value:function(){var e=[];for(var t in this.obj)this.obj.hasOwnProperty(t)&&e.push(t);return e}},{key:"getEnvParent",value:function(){return this.envParent}},{key:"getSvSymbolProcedure",value:function(){return this.svSymbolProcedure}},{key:"getParentStackFrame",value:function(){return this.parentStackFrame?this.parentStackFrame:this.envParent?this.envParent.getParentStackFrame():null}},{key:"get",value:function(e){if(e in this.obj)return this.obj[e];if(null==this.envParent)throw new Error("no binding for "+e);return this.envParent.get(e)}},{key:"set",value:function(e,t){if(e in this.obj)this.obj[e]=t;else{if(null==this.envParent)throw new Error(e+" is not declared");this.envParent.set(e,t)}}},{key:"define",value:function(e,t){if(e in this.obj)throw new Error(e+" is already defined");this.obj[e]=t}},{key:"setOrDefine",value:function(e,t){this.obj[e]=t}}]),e}(),b=n(19),w=n(0),y=function(){function e(){Object(v.a)(this,e),this.stepCount=1,this.step=0,this.evaluators=void 0}return Object(f.a)(e,[{key:"setEvaluators",value:function(e){this.evaluators=e}},{key:"setStepCount",value:function(e){this.stepCount=e,this.step=0}},{key:"matches",value:function(e){return!0}},{key:"evaluate",value:function(e,t,n){for(var r=this,a=0;a<this.evaluators.length;a++)if(this.evaluators[a].matches(e))return this.step++,this.step%this.stepCount===0?new w.c(function(){return r.evaluators[a].evaluate(e,t,n)},t).withSourceInfo(e,e):this.evaluators[a].evaluate(e,t,n);throw new Error("cannot evaluate "+e.toString())}},{key:"evaluateList",value:function(e,t,n){var r=this,a=w.d.Nil;return function e(i){return w.d.isNil(i)?new w.h(n,a):r.evaluate(w.d.car(i),t,function(t){a=t;var n=w.d.cdr(i);return e(n)})}(e)}}],[{key:"isTaggedList",value:function(e,t){if(!w.d.matches(e))return!1;var n=w.d.car(e);return w.g.matches(n)&&w.g.val(n)===t}}]),e}(),S=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return w.d.matches(e)}},{key:"evaluate",value:function(t,n,r){var a=this;return this.evaluator.evaluate(e.getOperator(t),n,function(i){if(!e.isPrimitiveProcedure(i)&&!e.isCompoundProcedure(i)&&!e.isContinuation(i))throw new Error("undefined procedure "+e.getOperator(t).toString());return a.evaluateArgs(e.getArguments(t),n,function(u){return e.evalCall(i,u,new p(t,n),r,a.evaluator)})})}},{key:"evaluateArgs",value:function(e,t,n){var r=this,a=new w.d(null,null);return function e(i,u){return w.d.isNil(u)?new w.h(n,a):r.evaluator.evaluate(w.d.car(u),t,function(t){return w.d.setCar(i,t),w.d.setCdr(i,new w.d(null,null)),e(w.d.cdr(i),w.d.cdr(u))})}(a,e)}}],[{key:"evalCall",value:function(e,t,n,r,a){if(this.isPrimitiveProcedure(e))return new w.h(r,this.getPrimitiveProcedureDelegate(e)(t));if(this.isContinuation(e)){var i=w.d.Nil;if(!w.d.isNil(t)){if(!w.d.isNil(w.d.cdr(t)))throw new Error("too many arguments");i=w.d.car(t)}return this.getContinuationFromCapturedContinuation(e)(i)}if(this.isCompoundProcedure(e)){for(var u=new _(this.getProcedureEnv(e),this.getProcedureSymbol(e),n),c=this.getProcedureParameters(e);!w.d.isNil(t)||!w.d.isNil(c);){if(w.d.isNil(t))throw new Error("not enough argument");if(w.d.isNil(c))throw new Error("too many arguments");var o=w.g.val(w.d.car(c)),s=w.d.car(t);u.define(o,s),c=w.d.cdr(c),t=w.d.cdr(t)}return a.evaluateList(this.getProcedureBody(e),u,r)}throw new Error("undefined procedure "+e.toString())}},{key:"isCompoundProcedure",value:function(e){return y.isTaggedList(e,"procedure")}},{key:"isPrimitiveProcedure",value:function(e){return y.isTaggedList(e,"primitive")}},{key:"isContinuation",value:function(e){return y.isTaggedList(e,"captured-continuation")}},{key:"getContinuationFromCapturedContinuation",value:function(e){return w.a.val(w.d.cdr(e))}},{key:"getProcedureSymbol",value:function(e){return w.g.cast(w.d.cadr(e))}},{key:"getProcedureParameters",value:function(e){return w.d.caddr(e)}},{key:"getProcedureBody",value:function(e){return w.d.cadddr(e)}},{key:"getProcedureEnv",value:function(e){return w.a.val(w.d.caddddr(e))}},{key:"getPrimitiveProcedureDelegate",value:function(e){return w.a.val(w.d.cdr(e))}},{key:"getOperator",value:function(e){return w.d.car(e)}},{key:"getArguments",value:function(e){return w.d.cdr(e)}}]),e}(),E=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"begin")}},{key:"evaluate",value:function(e,t,n){return this.evaluator.evaluateList(this.getBeginActions(e),t,n)}},{key:"getBeginActions",value:function(e){return w.d.cdr(e)}}]),e}(),O=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return w.c.matches(e)}},{key:"evaluate",value:function(e,t,n){return new w.h(n,w.c.cast(e).val()())}}]),e}(),j=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"call-with-current-continuation")}},{key:"evaluate",value:function(t,n,r){var a=this;return this.evaluator.evaluate(this.getLambda(t),n,function(i){var u=w.d.listFromRvs(e.createCcProcedure(r));return S.evalCall(i,u,new p(t,n),r,a.evaluator)})}},{key:"getLambda",value:function(e){return w.d.cadr(e)}}],[{key:"createCcProcedure",value:function(e){return new w.d(new w.g("captured-continuation"),new w.a(e))}}]),e}(),P=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"cond")}},{key:"getCondClauses",value:function(e){return w.d.cdr(e)}},{key:"isCondElseClause",value:function(e){return y.isTaggedList(e,"else")}},{key:"getCondPredicate",value:function(e){return w.d.car(e)}},{key:"getCondActions",value:function(e){return w.d.cdr(e)}},{key:"evaluate",value:function(e,t,n){var r=this;return function e(a){if(w.d.isNil(a))return new w.h(n,a);var i=w.d.car(a);return r.isCondElseClause(i)?r.evaluator.evaluateList(r.getCondActions(i),t,n):r.evaluator.evaluate(w.d.car(i),t,function(u){if(w.b.isTrue(u))return r.evaluator.evaluateList(r.getCondActions(i),t,n);var c=w.d.cdr(a);return e(c)})}(this.getCondClauses(e))}}]),e}(),C=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"lambda")}},{key:"evaluate",value:function(t,n,r){var a=e.createCompoundProcedure(new w.g("lambda"),e.getLambdaParameters(t),e.getLambdaBody(t),n);return new w.h(r,a)}}],[{key:"createCompoundProcedure",value:function(e,t,n,r){return w.d.listFromRvs(new w.g("procedure"),e,t,n,new w.a(r))}},{key:"getLambdaParameters",value:function(e){return w.d.cadr(e)}},{key:"getLambdaBody",value:function(e){return w.d.cddr(e)}}]),e}(),T=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"define")}},{key:"evaluate",value:function(e,t,n){var r=this;if(w.d.matches(this.getHead(e))){var a=C.createCompoundProcedure(this.getFunctionName(e),this.getLambdaParameters(e),this.getLambdaBody(e),t);return t.define(w.g.val(this.getFunctionName(e)),a),new w.h(n,a)}return this.evaluator.evaluate(this.getValue(e),t,function(a){return t.define(w.g.val(r.getVariable(e)),a),new w.h(n,a)})}},{key:"getHead",value:function(e){return w.d.cadr(e)}},{key:"getVariable",value:function(e){return this.getHead(e)}},{key:"getValue",value:function(e){return w.d.caddr(e)}},{key:"getFunctionName",value:function(e){return w.d.car(this.getHead(e))}},{key:"getLambdaParameters",value:function(e){return w.d.cdr(this.getHead(e))}},{key:"getLambdaBody",value:function(e){return w.d.cddr(e)}}]),e}(),x=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"if")}},{key:"evaluate",value:function(e,t,n){var r=this;return this.evaluator.evaluate(this.getIfPredicate(e),t,function(a){return w.b.isTrue(a)?r.evaluator.evaluate(r.getIfConsequent(e),t,n):r.evaluator.evaluate(r.getIfAlternative(e),t,n)})}},{key:"getIfPredicate",value:function(e){return w.d.cadr(e)}},{key:"getIfConsequent",value:function(e){return w.d.caddr(e)}},{key:"getIfAlternative",value:function(e){return w.d.isNil(w.d.cdddr(e))?w.d.Nil:w.d.cadddr(e)}}]),e}(),L=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(t){return e.isLet(t)||e.isLetStar(t)||e.isLetrec(t)}},{key:"evaluate",value:function(t,n,r){var a=this;if(e.isLet(t)){return function i(u,c){if(w.d.isNil(c))return a.evaluator.evaluateList(e.getBody(t),u,r);var o=w.d.car(c),s=w.d.car(o);return a.evaluator.evaluate(w.d.cadr(o),n,function(e){return u.define(w.g.val(s),e),i(u,w.d.cdr(c))})}(new _(n),e.getDefs(t))}if(e.isLetStar(t)){return function n(i,u){if(w.d.isNil(u))return a.evaluator.evaluateList(e.getBody(t),i,r);var c=w.d.car(u),o=w.d.car(c);return a.evaluator.evaluate(w.d.cadr(c),i,function(e){return(i=new _(i)).setOrDefine(w.g.val(o),e),n(i,w.d.cdr(u))})}(n,e.getDefs(t))}if(e.isLetrec(t)){for(var i=new _(n),u=e.getDefs(t);!w.d.isNil(u);){var c=w.d.car(u);i.define(w.g.val(w.d.car(c)),w.d.Nil),u=w.d.cdr(u)}return function n(i,u){if(w.d.isNil(u))return a.evaluator.evaluateList(e.getBody(t),i,r);var c=w.d.car(u),o=w.d.car(c);return a.evaluator.evaluate(w.d.cadr(c),i,function(e){return i.set(w.g.val(o),e),n(i,w.d.cdr(u))})}(i,e.getDefs(t))}throw new Error("uknown let kind")}}],[{key:"isLet",value:function(e){return y.isTaggedList(e,"let")}},{key:"isLetStar",value:function(e){return y.isTaggedList(e,"let*")}},{key:"isLetrec",value:function(e){return y.isTaggedList(e,"letrec")}},{key:"getDefs",value:function(e){return w.d.cadr(e)}},{key:"getBody",value:function(e){return w.d.cddr(e)}}]),e}(),N=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"quote")}},{key:"evaluate",value:function(e,t,n){var r=w.d.cdr(e);return new w.h(n,r)}}]),e}(),D=function(){function e(){Object(v.a)(this,e)}return Object(f.a)(e,[{key:"matches",value:function(e){return w.f.matches(e)||w.b.matches(e)||w.e.matches(e)||w.d.isNil(e)}},{key:"evaluate",value:function(e,t,n){return new w.h(n,e)}}]),e}(),I=function(){function e(){Object(v.a)(this,e)}return Object(f.a)(e,[{key:"matches",value:function(e){return w.g.matches(e)}},{key:"evaluate",value:function(e,t,n){var r=t.get(w.g.val(e));return new w.h(n,r)}}]),e}(),B=function(){function e(t){Object(v.a)(this,e),this.evaluator=t}return Object(f.a)(e,[{key:"matches",value:function(e){return y.isTaggedList(e,"set!")}},{key:"evaluate",value:function(e,t,n){var r=this;return this.evaluator.evaluate(this.getValue(e),t,function(a){return t.set(w.g.val(r.getVariable(e)),a),new w.h(n,a)})}},{key:"getVariable",value:function(e){return w.d.cadr(e)}},{key:"getValue",value:function(e){return w.d.caddr(e)}}]),e}(),F=function(){function e(){Object(v.a)(this,e),this.evaluator=void 0}return Object(f.a)(e,[{key:"evaluateString",value:function(e,t){var n=(new b.a).parse(e),r=new _(null);return r.define("cons",new w.d(new w.g("primitive"),new w.a(function(e){return new w.d(w.d.car(e),w.d.cadr(e))}))),r.define("null?",new w.d(new w.g("primitive"),new w.a(function(e){return w.b.fromBoolean(w.d.isNil(w.d.car(e)))}))),r.define("car",new w.d(new w.g("primitive"),new w.a(function(e){return w.d.car(w.d.car(e))}))),r.define("cadr",new w.d(new w.g("primitive"),new w.a(function(e){return w.d.cadr(w.d.car(e))}))),r.define("cdr",new w.d(new w.g("primitive"),new w.a(function(e){return w.d.cdr(w.d.car(e))}))),r.define("=",new w.d(new w.g("primitive"),new w.a(function(e){return w.b.fromBoolean(w.e.val(w.d.car(e))===w.e.val(w.d.cadr(e)))}))),r.define(">",new w.d(new w.g("primitive"),new w.a(function(e){return w.b.fromBoolean(w.e.val(w.d.car(e))>w.e.val(w.d.cadr(e)))}))),r.define("<",new w.d(new w.g("primitive"),new w.a(function(e){return w.b.fromBoolean(w.e.val(w.d.car(e))<w.e.val(w.d.cadr(e)))}))),r.define("*",new w.d(new w.g("primitive"),new w.a(function(e){return new w.e(w.e.val(w.d.car(e))*w.e.val(w.d.cadr(e)))}))),r.define("-",new w.d(new w.g("primitive"),new w.a(function(e){return new w.e(w.e.val(w.d.car(e))-w.e.val(w.d.cadr(e)))}))),r.define("+",new w.d(new w.g("primitive"),new w.a(function(e){return new w.e(w.e.val(w.d.car(e))+w.e.val(w.d.cadr(e)))}))),r.define("/",new w.d(new w.g("primitive"),new w.a(function(e){return new w.e(w.e.val(w.d.car(e))/w.e.val(w.d.cadr(e)))}))),r.define("min",new w.d(new w.g("primitive"),new w.a(function(e){return new w.e(Math.min(w.e.val(w.d.car(e)),w.e.val(w.d.cadr(e))))}))),r.define("max",new w.d(new w.g("primitive"),new w.a(function(e){return new w.e(Math.max(w.e.val(w.d.car(e)),w.e.val(w.d.cadr(e))))}))),r.define("abs",new w.d(new w.g("primitive"),new w.a(function(e){return new w.e(Math.abs(w.e.val(w.d.car(e))))}))),r.define("zero?",new w.d(new w.g("primitive"),new w.a(function(e){return w.b.fromBoolean(0===w.e.val(w.d.car(e)))}))),r.define("length",new w.d(new w.g("primitive"),new w.a(function(e){return w.d.lengthI(w.d.car(e))}))),r.define("not",new w.d(new w.g("primitive"),new w.a(function(e){return w.b.not(w.d.car(e))}))),r.define("and",new w.d(new w.g("primitive"),new w.a(function(e){return w.b.and(e)}))),r.define("or",new w.d(new w.g("primitive"),new w.a(function(e){return w.b.or(e)}))),r.define("display",new w.d(new w.g("primitive"),new w.a(function(e){for(;!w.d.isNil(e);)t(w.d.car(e).toDisplayString()),e=w.d.cdr(e);return w.d.Nil}))),r.define("newline",new w.d(new w.g("primitive"),new w.a(function(e){return t("\n"),w.d.Nil}))),this.evaluator=new y,this.evaluator.setEvaluators([new O(this.evaluator),new D,new I,new L(this.evaluator),new N(this.evaluator),new P(this.evaluator),new T(this.evaluator),new B(this.evaluator),new x(this.evaluator),new E(this.evaluator),new C(this.evaluator),new j(this.evaluator),new S(this.evaluator)]),this.evaluator.evaluateList(n,new _(r),function(e){return e})}},{key:"step",value:function(e,t){if(this.evaluator.setStepCount(t),w.c.matches(e))for(e=w.c.cast(e).val()();w.h.matches(e);)e=w.h.call(e);return w.c.matches(e)?e:null}}]),e}();function K(e){if("paused"!==e.kind)return null;for(var t=new p(e.sv,e.sv.env()),n=0;t&&n<e.currentStackFrameIndex;n++)t=t.parent();return t}var M=function(e){var t=e.samples.map(function(e){var t=e.split("\n")[0].trim().replace(/^; /,"");return a.a.createElement("option",{key:e},t)});return a.a.createElement("select",{className:"sicp-editor-select-sample",onChange:function(t){e.onSampleSelected(t.target.selectedIndex)}},t)},R=function(e){return a.a.createElement("div",{className:"sicp-editor-toolbar"},e.onRun&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onRun},"run"),e.onPause&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onPause},"pause"),e.onStop&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onStop},"stop"),e.onStep&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onStep},"step"),e.onContinue&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onContinue},"continue"),a.a.createElement(M,{samples:e.samples,onSampleSelected:e.onSampleSelected}))},A=function(e){var t=K(e.debuggerState);if(null==t)return a.a.createElement("div",null);for(var n=t.env(),r=[];n;)r.push(a.a.createElement("div",null,a.a.createElement("p",{className:"sicp-tree-node-title"},"Scope"),n.getNames().length>0&&a.a.createElement("div",{className:"sicp-tree-node-content"},n.getNames().map(function(e){return a.a.createElement("div",{key:e},a.a.createElement("div",{className:"sicp-variable-name"},e),a.a.createElement("div",{className:"sicp-variable-value"},n.get(e).toDisplayString()))})),0===n.getNames().length&&a.a.createElement("p",{className:"sicp-scope-empty"},"\xab empty \xbb"))),n=n.getEnvParent();return a.a.createElement("div",null,r)},U=function(e){var t=e.debuggerState;if("paused"!==t.kind||!w.c.matches(t.sv))return a.a.createElement("div",null);for(var n=t.sv,r=new p(n,n.env()),i=0,u=[],c=function(){for(var n=i,c=r.env();null!=c&&null==c.getSvSymbolProcedure();)c=c.getEnvParent();var o="sicp-stack-frame "+(n===t.currentStackFrameIndex?"sicp-stack-frame-current":"");u.push(a.a.createElement("div",{className:o,key:i,onClick:function(){return e.onStackFrameSelect(n)}},a.a.createElement("p",null,c?c.getSvSymbolProcedure().toString():"\xab not in procedure \xbb"))),r=r.parent(),i++};r;)c();return a.a.createElement("div",null,u)},W=function(){function e(){var t=this;Object(v.a)(this,e),this.output=void 0,this.log=function(e){t.output+=e}}return Object(f.a)(e,[{key:"clear",value:function(){this.output=""}}]),e}(),q=function(e){if(!e.text)return a.a.createElement("div",null);var t=e.text.split("\n").map(function(e){return a.a.createElement("div",null,e)});return a.a.createElement("div",null,t)},V=function(e){Object(h.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(v.a)(this,n),(r=t.call(this,e)).setSampleIndex=function(e){var t;r.stop(),r.setState({program:null!==(t=r.state.samples[e])&&void 0!==t?t:"",currentSampleIndex:e})},r.run=function(){r.setState({debuggerState:{kind:"running",sv:null}})},r.stop=function(){"stopped"!==r.state.debuggerState.kind&&r.setState({debuggerState:{kind:"stopped"}})},r.step=function(){var e=r.state.debuggerState;"paused"===e.kind?r.setState({debuggerState:Object(d.a)(Object(d.a)({},e),{},{kind:"step"})}):"stopped"===e.kind&&r.setState({debuggerState:{kind:"step",sv:null}})},r.cont=function(){var e=r.state.debuggerState;"paused"===e.kind&&r.setState({debuggerState:Object(d.a)(Object(d.a)({},e),{},{kind:"running"})})},r.pause=function(){var e=r.state.debuggerState;"running"===e.kind&&w.c.matches(e.sv)&&r.setState({debuggerState:{kind:"paused",sv:e.sv,currentStackFrameIndex:0}})},r.setStackFrameIndex=function(e){var t=r.state.debuggerState;"paused"===t.kind&&r.setState({debuggerState:Object(d.a)(Object(d.a)({},t),{},{kind:"paused",currentStackFrameIndex:e})})},r.edit=function(e){r.stop(),r.setState({program:e})},r.stepInterpreter=function(){var e=r.state,t=e.debuggerState,n=e.interpreter,a=e.logger,i=e.program;if("running"===t.kind||"step"===t.kind)try{var u=t.sv;null==u?(r.stop(),a.clear(),u=n.evaluateString(i,a.log)):u=n.step(t.sv,"running"===t.kind?1e4:1),null==u?r.setState({debuggerState:{kind:"stopped"}}):"running"===t.kind?r.setState({debuggerState:{kind:"running",sv:u}}):w.c.matches(u)?r.setState({debuggerState:{kind:"paused",sv:u,currentStackFrameIndex:0}}):r.setState({debuggerState:{kind:"stopped"}})}catch(c){console.log(c),a.log("\n"+c),r.setState({debuggerState:{kind:"stopped"}})}},r.state={program:"",samples:[],currentSampleIndex:0,logger:new W,interpreter:new F,debuggerState:{kind:"stopped"},editorRef:a.a.createRef()},function(){var t=Object(l.a)(o.a.mark(function t(){var n,r,a,i,u;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=Object(s.a)(e.sampleUrls),t.prev=2,r.s();case 4:if((a=r.n()).done){t.next=16;break}return i=a.value,t.next=8,fetch(i);case 8:return u=t.sent,t.t0=n,t.next=12,u.text();case 12:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 14:t.next=4;break;case 16:t.next=21;break;case 18:t.prev=18,t.t2=t.catch(2),r.e(t.t2);case 21:return t.prev=21,r.f(),t.finish(21);case 24:return t.abrupt("return",n);case 25:case"end":return t.stop()}},t,null,[[2,18,21,24]])}));return function(){return t.apply(this,arguments)}}()().then(function(e){r.setState({samples:e}),r.setSampleIndex(0)}),r}return Object(f.a)(n,[{key:"render",value:function(){var e=this.state,t=e.samples,n=e.debuggerState,r=e.editorRef,i=e.logger,u=e.program;"running"!==n.kind&&"step"!==n.kind||setTimeout(this.stepInterpreter,0);var c,o=[],s=K(n);"paused"===n.kind&&null!=s&&(o.push({startRow:s.sv().ilineStart,endRow:s.sv().ilineEnd,startCol:s.sv().icolStart,endCol:s.sv().icolEnd,className:"current-statement",type:"text"}),null===(c=r.current)||void 0===c||c.editor.gotoLine(s.sv().ilineStart));return a.a.createElement("div",{id:"editor-wrap"},a.a.createElement("div",{id:"editor"},a.a.createElement(R,{samples:t,onSampleSelected:this.setSampleIndex,onRun:"stopped"===n.kind?this.run:null,onStop:"paused"===n.kind||"running"===n.kind?this.stop:null,onPause:"running"===n.kind?this.pause:null,onStep:"paused"===n.kind||"stopped"===n.kind?this.step:null,onContinue:"paused"===n.kind?this.cont:null}),a.a.createElement(k.a,{ref:r,onChange:this.edit,className:"editorWindow",mode:"typescript",theme:"tomorrow_night",name:"ace-editor",editorProps:{$blockScrolling:!1},value:u,showGutter:!0,width:"auto",height:"auto",markers:o})),a.a.createElement("div",{id:"editor-bottom"},a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Output"),a.a.createElement("div",{id:"output-content",className:"sicp-box-tab-content"},a.a.createElement(q,{text:i.output}))),a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Stacktrace"),a.a.createElement("div",{id:"stacktrace-content",className:"sicp-box-tab-content"},a.a.createElement(U,{debuggerState:n,onStackFrameSelect:this.setStackFrameIndex}))),a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Variables"),a.a.createElement("div",{id:"variables-content",className:"sicp-box-tab-content"},a.a.createElement(A,{debuggerState:n})))))}}]),n}(a.a.PureComponent),H=["samples/factorial.ms","samples/odd-or-even.ms","samples/counting-change.ms","samples/hanoi.ms","samples/n-queens.ms","samples/return-with-callcc.ms","samples/lazy-generator.ms","samples/yin-yang.ms"];var Q=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{id:"header"},a.a.createElement("h2",null,"Mini scheme"),a.a.createElement("p",null,"by ",a.a.createElement("a",{href:"https://csokavar.hu"},"encse"))),a.a.createElement(V,{sampleUrls:H}),a.a.createElement("div",{id:"footer"},"Copyright 2015, source is available on ",a.a.createElement("a",{href:"https://github.com/encse/sicp"},"GitHub")))},J=document.getElementById("root");u.a.render(a.a.createElement(Q,null),J)}},[[21,1,2]]]);
//# sourceMappingURL=main.a206ebfe.chunk.js.map