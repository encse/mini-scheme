(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{0:function(e,t,n){"use strict";n.d(t,"d",function(){return s}),n.d(t,"b",function(){return l}),n.d(t,"f",function(){return v}),n.d(t,"c",function(){return d}),n.d(t,"a",function(){return h}),n.d(t,"g",function(){return f}),n.d(t,"e",function(){return m}),n.d(t,"h",function(){return k});var r=n(5),a=n(4),i=n(2),u=n(3),c=function(){function e(){Object(i.a)(this,e),this.ilineStart=void 0,this.icolStart=void 0,this.ilineEnd=void 0,this.icolEnd=void 0}return Object(u.a)(e,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"withSourceInfo",value:function(e,t){return this.ilineStart=e.ilineStart,this.icolStart=e.icolStart,this.ilineEnd=t.ilineEnd,this.icolEnd=t.icolEnd,this}}]),e}(),o=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(){return Object(i.a)(this,n),t.apply(this,arguments)}return Object(u.a)(n,null,[{key:"matches",value:function(e){return!d.matches(e)}}]),n}(c),s=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this)).cont=e,a.val=r,a}return Object(u.a)(n,null,[{key:"matches",value:function(e){return e instanceof n}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("Cont expected");return e}},{key:"call",value:function(e){return n.cast(e).cont(e.val)}}]),n}(c),l=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this))._val=e,a._env=r,a}return Object(u.a)(n,[{key:"env",value:function(){return this._env}},{key:"val",value:function(){return this._val}},{key:"toString",value:function(){return"T("+this._val.toString()+")"}},{key:"toDisplayString",value:function(){return""}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("Breakpoint expected");return e}}]),n}(c),v=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this)).name=e,a.delegate=r,a}return Object(u.a)(n,[{key:"toString",value:function(){return"(fn ".concat(this.name,")")}}],[{key:"matches",value:function(e){return e instanceof n}}]),n}(c),d=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e,r){var a;return Object(i.a)(this,n),(a=t.call(this))._car=e,a._cdr=r,a}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toStringI(function(e){return e.toDisplayString()})}},{key:"toString",value:function(){return this.toStringI(function(e){return e.toString()})}},{key:"toStringI",value:function(e){for(var t="(",r=!0,a=this;!n.isNil(a);){if(r||(t+=" "),!n.matches(a)){t+=e(a);break}if(t+=e(n.car(a)),a=n.cdr(a),o.matches(a)){t+=" . "+e(a);break}r=!1}return t+=")"}}],[{key:"cons",value:function(e,t){return new n(e,t)}},{key:"listFromRvs",value:function(){for(var e=arguments.length,t=new Array(e),r=0;r<e;r++)t[r]=arguments[r];return n.listFromRvArray(t)}},{key:"listFromRvArray",value:function(e){for(var t=n.Nil,r=e.length-1;r>=0;r--)t=new n(e[r],t);return t}},{key:"matches",value:function(e){return e instanceof n}},{key:"isNil",value:function(e){return e===n.Nil||n.matches(e)&&null===n.car(e)&&null===n.cdr(e)}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("Cons expected");return e}},{key:"car",value:function(e){return n.cast(e)._car}},{key:"cdr",value:function(e){return n.cast(e)._cdr}},{key:"setCar",value:function(e,t){return n.cast(e)._car=t,e}},{key:"setCdr",value:function(e,t){return n.cast(e)._cdr=t,e}},{key:"cadr",value:function(e){return this.car(this.cdr(e))}},{key:"cddr",value:function(e){return this.cdr(this.cdr(e))}},{key:"caddr",value:function(e){return this.car(this.cddr(e))}},{key:"cdddr",value:function(e){return this.cdr(this.cddr(e))}},{key:"cddddr",value:function(e){return this.cdr(this.cdddr(e))}},{key:"cadddr",value:function(e){return this.car(this.cdddr(e))}},{key:"caddddr",value:function(e){return this.car(this.cddddr(e))}},{key:"lengthI",value:function(e){for(var t=0;!this.isNil(e);)t++,e=this.cdr(e);return new m(t)}}]),n}(c);d.Nil=new d(null,null);var h=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return this._val?"#t":"#f"}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"isTrue",value:function(e){return n.matches(e)&&n.val(e)}},{key:"isFalse",value:function(e){return n.matches(e)&&!n.val(e)}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("bool expected");return e}},{key:"not",value:function(e){return this.isTrue(e)?n.False:n.True}},{key:"and",value:function(e){for(;!d.isNil(e);){if(!this.isTrue(d.car(e)))return n.False;e=d.cdr(e)}return n.True}},{key:"or",value:function(e){for(;!d.isNil(e);){if(this.isTrue(d.car(e)))return n.True;e=d.cdr(e)}return n.False}},{key:"fromBoolean",value:function(e){return e?n.True:n.False}}]),n}(c);h.True=new h(!0),h.False=new h(!1);var f=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this._val}},{key:"toString",value:function(){return JSON.stringify(this._val)}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("string expected");return e}}]),n}(c),m=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return""+this._val}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("Number expected");return e}}]),n}(c),k=function(e){Object(r.a)(n,e);var t=Object(a.a)(n);function n(e){var r;return Object(i.a)(this,n),(r=t.call(this))._val=e,r}return Object(u.a)(n,[{key:"toDisplayString",value:function(){return this.toString()}},{key:"toString",value:function(){return this._val}}],[{key:"matches",value:function(e){return e instanceof n}},{key:"val",value:function(e){return n.cast(e)._val}},{key:"cast",value:function(e){if(!n.matches(e))throw new Error("Symbol expected");return e}}]),n}(c)},20:function(module,__webpack_exports__,__webpack_require__){"use strict";__webpack_require__.d(__webpack_exports__,"a",function(){return Parser});var _home_runner_work_mini_scheme_mini_scheme_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__(2),_home_runner_work_mini_scheme_mini_scheme_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__(3),_sv__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__(0),TokenKind;!function(e){e[e.WhiteSpace=0]="WhiteSpace",e[e.BooleanLit=1]="BooleanLit",e[e.LParen=2]="LParen",e[e.RParen=3]="RParen",e[e.Symbol=4]="Symbol",e[e.NumberLit=5]="NumberLit",e[e.Quote=6]="Quote",e[e.StringLit=7]="StringLit",e[e.Comment=8]="Comment",e[e.EOF=9]="EOF"}(TokenKind||(TokenKind={}));var Parser=function(){function Parser(){Object(_home_runner_work_mini_scheme_mini_scheme_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,Parser),this.regexSymbol=/^[^\s()',]+/,this.regexNumber=/^[-+]?[0-9]*\.?[0-9]+([eE][-+]?[0-9]+)?/,this.regexString=/^"([^\\"]+|\\.)*"/,this.regexWhiteSpace=/^\s*/,this.regexBoolean=/^#t|^#f/,this.regexComment=/^;.*/,this.tokens=void 0,this.itoken=0}return Object(_home_runner_work_mini_scheme_mini_scheme_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(Parser,[{key:"parse",value:function(e){this.tokens=this.getTokens(e).filter(function(e){return e.kind!==TokenKind.WhiteSpace&&e.kind!==TokenKind.Comment});var t=this.tokens.length?this.tokens[this.tokens.length-1]:null;this.tokens.push(t?new Token(TokenKind.EOF,"",t.ilineEnd,t.icolEnd+1):new Token(TokenKind.EOF,"",0,0)),this.itoken=0;for(var n=[];!this.accept(TokenKind.EOF);)n.push(this.parseExpression());return _sv__WEBPACK_IMPORTED_MODULE_2__.c.listFromRvArray(n)}},{key:"nextToken",value:function(){this.itoken<this.tokens.length-1&&this.itoken++}},{key:"currentToken",value:function(){return this.tokens[this.itoken]}},{key:"accept",value:function(e){return this.currentToken().kind===e&&(this.nextToken(),!0)}},{key:"expect",value:function(e){if(this.accept(e))return!0;throw new Error("expected "+e+" found "+this.currentToken().kind)}},{key:"parseExpression",value:function parseExpression(){var token=this.currentToken();if(this.accept(TokenKind.Quote)){var svBody=this.parseExpression();return new _sv__WEBPACK_IMPORTED_MODULE_2__.c(new _sv__WEBPACK_IMPORTED_MODULE_2__.h("quote"),svBody).withSourceInfo(token,svBody)}if(this.accept(TokenKind.Symbol))return new _sv__WEBPACK_IMPORTED_MODULE_2__.h(token.st).withSourceInfo(token,token);if(this.accept(TokenKind.BooleanLit))return _sv__WEBPACK_IMPORTED_MODULE_2__.a.fromBoolean("#t"===token.st).withSourceInfo(token,token);if(this.accept(TokenKind.NumberLit))return new _sv__WEBPACK_IMPORTED_MODULE_2__.e(eval(token.st)).withSourceInfo(token,token);if(this.accept(TokenKind.StringLit))return new _sv__WEBPACK_IMPORTED_MODULE_2__.g(eval(token.st)).withSourceInfo(token,token);if(this.accept(TokenKind.LParen)){for(var tokenStart=token,exprs=[];!this.accept(TokenKind.RParen);){if(this.accept(TokenKind.EOF))throw new Error("unexpected end of input");exprs.push(this.parseExpression())}var tokenEnd=this.tokens[this.itoken-1];return _sv__WEBPACK_IMPORTED_MODULE_2__.c.listFromRvArray(exprs).withSourceInfo(tokenStart,tokenEnd)}throw new Error("invalid token "+token)}},{key:"getTokens",value:function(e){for(var t=[],n=0,r=0;e.length>0;){var a=e[0],i=void 0;if("("===a)i=new Token(TokenKind.LParen,a,n,r);else if(")"===a)i=new Token(TokenKind.RParen,a,n,r);else if("'"===a)i=new Token(TokenKind.Quote,a,n,r);else if(this.regexNumber.test(e))i=new Token(TokenKind.NumberLit,this.regexNumber.exec(e)[0],n,r);else if(this.regexString.test(e))i=new Token(TokenKind.StringLit,this.regexString.exec(e)[0],n,r);else if(this.regexBoolean.test(e))i=new Token(TokenKind.BooleanLit,this.regexBoolean.exec(e)[0],n,r);else if(this.regexComment.test(e))i=new Token(TokenKind.Comment,this.regexComment.exec(e)[0],n,r);else if(this.regexSymbol.test(e))i=new Token(TokenKind.Symbol,this.regexSymbol.exec(e)[0],n,r);else{if(!this.regexWhiteSpace.test(e))throw new Error("invalid token at '"+e+"'");i=new Token(TokenKind.WhiteSpace,this.regexWhiteSpace.exec(e)[0],n,r)}if(t.push(i),0===i.st.length)throw new Error("invalid token");e=e.substr(i.st.length),n=i.ilineEnd,r=i.icolEnd}return t}}]),Parser}(),Token=Object(_home_runner_work_mini_scheme_mini_scheme_node_modules_babel_runtime_helpers_esm_createClass__WEBPACK_IMPORTED_MODULE_1__.a)(function e(t,n,r,a){Object(_home_runner_work_mini_scheme_mini_scheme_node_modules_babel_runtime_helpers_esm_classCallCheck__WEBPACK_IMPORTED_MODULE_0__.a)(this,e),this.kind=t,this.st=n,this.ilineStart=r,this.icolStart=a,this.ilineEnd=void 0,this.icolEnd=void 0;var i=n.replace("\r","").split("\n");this.ilineEnd=this.ilineStart+i.length-1,this.ilineStart===this.ilineEnd?this.icolEnd=a+i[0].length:this.icolEnd=i[i.length-1].length})},21:function(e,t,n){e.exports=n(39)},26:function(e,t,n){},39:function(e,t,n){"use strict";n.r(t);var r=n(1),a=n.n(r),i=n(17),u=n.n(i),c=(n(26),n(10)),o=n.n(c),s=n(7),l=n(18),v=n(6),d=n(2),h=n(3),f=n(5),m=n(4),k=n(19),g=n.n(k),p=(n(36),n(38),function(){function e(t,n){Object(d.a)(this,e),this._sv=t,this._env=n}return Object(h.a)(e,[{key:"sv",value:function(){return this._sv}},{key:"env",value:function(){return this._env}},{key:"parent",value:function(){return this._env.getParentStackFrame()}}]),e}()),_=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;Object(d.a)(this,e),this.obj={},this.envParent=null,this.svSymbolProcedure=void 0,this.parentStackFrame=void 0,this.envParent=t,this.svSymbolProcedure=n,this.parentStackFrame=r}return Object(h.a)(e,[{key:"getNames",value:function(){var e=[];for(var t in this.obj)this.obj.hasOwnProperty(t)&&e.push(t);return e}},{key:"getEnvParent",value:function(){return this.envParent}},{key:"getSvSymbolProcedure",value:function(){return this.svSymbolProcedure}},{key:"getParentStackFrame",value:function(){return this.parentStackFrame?this.parentStackFrame:this.envParent?this.envParent.getParentStackFrame():null}},{key:"get",value:function(e){if(e in this.obj)return this.obj[e];if(null==this.envParent)throw new Error("no binding for "+e);return this.envParent.get(e)}},{key:"set",value:function(e,t){if(e in this.obj)this.obj[e]=t;else{if(null==this.envParent)throw new Error(e+" is not declared");this.envParent.set(e,t)}}},{key:"define",value:function(e,t){if(e in this.obj)throw new Error(e+" is already defined");this.obj[e]=t}},{key:"setOrDefine",value:function(e,t){this.obj[e]=t}}]),e}(),b=n(20),y=n(0),S=function(){function e(){Object(d.a)(this,e),this.stepCount=1,this.step=0,this.evaluators=void 0}return Object(h.a)(e,[{key:"setEvaluators",value:function(e){this.evaluators=e}},{key:"setStepCount",value:function(e){this.stepCount=e,this.step=0}},{key:"matches",value:function(e){return!0}},{key:"evaluate",value:function(e,t,n){for(var r=this,a=0;a<this.evaluators.length;a++)if(this.evaluators[a].matches(e))return this.step++,this.step%this.stepCount===0?new y.b(function(){return r.evaluators[a].evaluate(e,t,n)},t).withSourceInfo(e,e):this.evaluators[a].evaluate(e,t,n);throw new Error("cannot evaluate "+e.toString())}},{key:"evaluateList",value:function(e,t,n){var r=this,a=y.c.Nil;return function e(i){return y.c.isNil(i)?new y.d(n,a):r.evaluate(y.c.car(i),t,function(t){a=t;var n=y.c.cdr(i);return e(n)})}(e)}}],[{key:"isTaggedList",value:function(e,t){if(!y.c.matches(e))return!1;var n=y.c.car(e);return y.h.matches(n)&&y.h.val(n)===t}}]),e}(),w=function(){function e(t){Object(d.a)(this,e),this.evaluator=t}return Object(h.a)(e,[{key:"matches",value:function(e){return y.c.matches(e)}},{key:"evaluate",value:function(t,n,r){var a=this;return this.evaluator.evaluate(e.getOperator(t),n,function(i){if(!y.f.matches(i))throw new Error("undefined procedure "+e.getOperator(t).toString());return a.evaluateArgs(e.getArguments(t),n,function(u){return e.evalCall(i,u,new p(t,n),r,a.evaluator)})})}},{key:"evaluateArgs",value:function(e,t,n){var r=this,a=new y.c(null,null);return function e(i,u){return y.c.isNil(u)?new y.d(n,a):r.evaluator.evaluate(y.c.car(u),t,function(t){return y.c.setCar(i,t),y.c.setCdr(i,new y.c(null,null)),e(y.c.cdr(i),y.c.cdr(u))})}(a,e)}}],[{key:"evalCall",value:function(e,t,n,r,a){if(y.f.matches(e))return e.delegate(t,n,a,r);throw new Error("undefined procedure "+e.toString())}},{key:"getOperator",value:function(e){return y.c.car(e)}},{key:"getArguments",value:function(e){return y.c.cdr(e)}}]),e}(),E=function(){function e(t){Object(d.a)(this,e),this.evaluator=t}return Object(h.a)(e,[{key:"matches",value:function(e){return S.isTaggedList(e,"begin")}},{key:"evaluate",value:function(e,t,n){return this.evaluator.evaluateList(this.getBeginActions(e),t,n)}},{key:"getBeginActions",value:function(e){return y.c.cdr(e)}}]),e}(),O=function(){function e(t){Object(d.a)(this,e),this.evaluator=t}return Object(h.a)(e,[{key:"matches",value:function(e){return y.b.matches(e)}},{key:"evaluate",value:function(e,t,n){return new y.d(n,y.b.cast(e).val()())}}]),e}(),j=function(){function e(t){Object(d.a)(this,e),this.evaluator=t}return Object(h.a)(e,[{key:"matches",value:function(e){return S.isTaggedList(e,"call-with-current-continuation")}},{key:"evaluate",value:function(t,n,r){var a=this;return this.evaluator.evaluate(this.getLambda(t),n,function(i){var u=y.c.listFromRvs(e.createCcProcedure(r));return w.evalCall(i,u,new p(t,n),r,a.evaluator)})}},{key:"getLambda",value:function(e){return y.c.cadr(e)}}],[{key:"createCcProcedure",value:function(e){return new y.f(new y.h("captured-continuation"),function(t){var n=y.c.Nil;if(!y.c.isNil(t)){if(!y.c.isNil(y.c.cdr(t)))throw new Error("too many arguments");n=y.c.car(t)}return e(n)})}}]),e}(),T=function(){function e(t){Object(d.a)(this,e),this.evaluator=t}return Object(h.a)(e,[{key:"matches",value:function(e){return S.isTaggedList(e,"cond")}},{key:"getCondClauses",value:function(e){return y.c.cdr(e)}},{key:"isCondElseClause",value:function(e){return S.isTaggedList(e,"else")}},{key:"getCondPredicate",value:function(e){return y.c.car(e)}},{key:"getCondActions",value:function(e){return y.c.cdr(e)}},{key:"evaluate",value:function(e,t,n){var r=this;return function e(a){if(y.c.isNil(a))return new y.d(n,a);var i=y.c.car(a);return r.isCondElseClause(i)?r.evaluator.evaluateList(r.getCondActions(i),t,n):r.evaluator.evaluate(y.c.car(i),t,function(u){if(y.a.isTrue(u))return r.evaluator.evaluateList(r.getCondActions(i),t,n);var c=y.c.cdr(a);return e(c)})}(this.getCondClauses(e))}}]),e}(),P=function(){function e(t){Object(d.a)(this,e),this.evaluator=t}return Object(h.a)(e,[{key:"matches",value:function(e){return S.isTaggedList(e,"define")}},{key:"evaluate",value:function(t,n,r){var a=this;if(y.c.matches(this.getHead(t))){var i=y.h.cast(this.getFunctionName(t)),u=e.makeProc(i,n,this.getLambdaParameters(t),this.getLambdaBody(t));return n.define(i._val,u),new y.d(r,u)}return this.evaluator.evaluate(this.getValue(t),n,function(e){return n.define(y.h.val(a.getVariable(t)),e),new y.d(r,e)})}},{key:"getHead",value:function(e){return y.c.cadr(e)}},{key:"getVariable",value:function(e){return this.getHead(e)}},{key:"getValue",value:function(e){return y.c.caddr(e)}},{key:"getFunctionName",value:function(e){return y.c.car(this.getHead(e))}},{key:"getLambdaParameters",value:function(e){return y.c.cdr(this.getHead(e))}},{key:"getLambdaBody",value:function(e){return y.c.cddr(e)}}],[{key:"makeProc",value:function(e,t,n,r){return new y.f(e,function(a,i,u,c){for(var o=new _(t,e,i),s=n;!y.c.isNil(a)||!y.c.isNil(s);){if(y.c.isNil(a))throw new Error("not enough argument");if(y.c.isNil(s))throw new Error("too many arguments");var l=y.h.val(y.c.car(s)),v=y.c.car(a);o.define(l,v),s=y.c.cdr(s),a=y.c.cdr(a)}return u.evaluateList(r,o,c)})}}]),e}(),x=function(){function e(t){Object(d.a)(this,e),this.evaluator=t}return Object(h.a)(e,[{key:"matches",value:function(e){return S.isTaggedList(e,"if")}},{key:"evaluate",value:function(e,t,n){var r=this;return this.evaluator.evaluate(this.getIfPredicate(e),t,function(a){return y.a.isTrue(a)?r.evaluator.evaluate(r.getIfConsequent(e),t,n):r.evaluator.evaluate(r.getIfAlternative(e),t,n)})}},{key:"getIfPredicate",value:function(e){return y.c.cadr(e)}},{key:"getIfConsequent",value:function(e){return y.c.caddr(e)}},{key:"getIfAlternative",value:function(e){return y.c.isNil(y.c.cdddr(e))?y.c.Nil:y.c.cadddr(e)}}]),e}(),C=function(){function e(t){Object(d.a)(this,e),this.evaluator=t}return Object(h.a)(e,[{key:"matches",value:function(e){return S.isTaggedList(e,"lambda")}},{key:"evaluate",value:function(t,n,r){var a=P.makeProc(new y.h("\xablambda\xbb"),n,e.getLambdaParameters(t),e.getLambdaBody(t));return new y.d(r,a)}}],[{key:"getLambdaParameters",value:function(e){return y.c.cadr(e)}},{key:"getLambdaBody",value:function(e){return y.c.cddr(e)}}]),e}(),L=function(){function e(t){Object(d.a)(this,e),this.evaluator=t}return Object(h.a)(e,[{key:"matches",value:function(t){return e.isLet(t)||e.isLetStar(t)||e.isLetrec(t)}},{key:"evaluate",value:function(t,n,r){var a=this;if(e.isLet(t)){return function i(u,c){if(y.c.isNil(c))return a.evaluator.evaluateList(e.getBody(t),u,r);var o=y.c.car(c),s=y.c.car(o);return a.evaluator.evaluate(y.c.cadr(o),n,function(e){return u.define(y.h.val(s),e),i(u,y.c.cdr(c))})}(new _(n),e.getDefs(t))}if(e.isLetStar(t)){return function n(i,u){if(y.c.isNil(u))return a.evaluator.evaluateList(e.getBody(t),i,r);var c=y.c.car(u),o=y.c.car(c);return a.evaluator.evaluate(y.c.cadr(c),i,function(e){return(i=new _(i)).setOrDefine(y.h.val(o),e),n(i,y.c.cdr(u))})}(n,e.getDefs(t))}if(e.isLetrec(t)){for(var i=new _(n),u=e.getDefs(t);!y.c.isNil(u);){var c=y.c.car(u);i.define(y.h.val(y.c.car(c)),y.c.Nil),u=y.c.cdr(u)}return function n(i,u){if(y.c.isNil(u))return a.evaluator.evaluateList(e.getBody(t),i,r);var c=y.c.car(u),o=y.c.car(c);return a.evaluator.evaluate(y.c.cadr(c),i,function(e){return i.set(y.h.val(o),e),n(i,y.c.cdr(u))})}(i,e.getDefs(t))}throw new Error("uknown let kind")}}],[{key:"isLet",value:function(e){return S.isTaggedList(e,"let")}},{key:"isLetStar",value:function(e){return S.isTaggedList(e,"let*")}},{key:"isLetrec",value:function(e){return S.isTaggedList(e,"letrec")}},{key:"getDefs",value:function(e){return y.c.cadr(e)}},{key:"getBody",value:function(e){return y.c.cddr(e)}}]),e}(),N=function(){function e(t){Object(d.a)(this,e),this.evaluator=t}return Object(h.a)(e,[{key:"matches",value:function(e){return S.isTaggedList(e,"quote")}},{key:"evaluate",value:function(e,t,n){var r=y.c.cdr(e);return new y.d(n,r)}}]),e}(),I=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,[{key:"matches",value:function(e){return y.g.matches(e)||y.a.matches(e)||y.e.matches(e)||y.c.isNil(e)}},{key:"evaluate",value:function(e,t,n){return new y.d(n,e)}}]),e}(),D=function(){function e(){Object(d.a)(this,e)}return Object(h.a)(e,[{key:"matches",value:function(e){return y.h.matches(e)}},{key:"evaluate",value:function(e,t,n){var r=t.get(y.h.val(e));return new y.d(n,r)}}]),e}(),B=function(){function e(t){Object(d.a)(this,e),this.evaluator=t}return Object(h.a)(e,[{key:"matches",value:function(e){return S.isTaggedList(e,"set!")}},{key:"evaluate",value:function(e,t,n){var r=this;return this.evaluator.evaluate(this.getValue(e),t,function(a){return t.set(y.h.val(r.getVariable(e)),a),new y.d(n,a)})}},{key:"getVariable",value:function(e){return y.c.cadr(e)}},{key:"getValue",value:function(e){return y.c.caddr(e)}}]),e}(),K=function(){function e(){Object(d.a)(this,e),this.evaluator=void 0}return Object(h.a)(e,[{key:"evaluateString",value:function(e,t){var n=(new b.a).parse(e),r=new _(null),a=function(e,t){r.define(e,new y.f(new y.h(e),function(e,n,r,a){return new y.d(a,t(e))}))};return a("cons",function(e){return new y.c(y.c.car(e),y.c.cadr(e))}),a("null?",function(e){return y.a.fromBoolean(y.c.isNil(y.c.car(e)))}),a("car",function(e){return y.c.car(y.c.car(e))}),a("cadr",function(e){return y.c.cadr(y.c.car(e))}),a("cdr",function(e){return y.c.cdr(y.c.car(e))}),a("=",function(e){return y.a.fromBoolean(y.e.val(y.c.car(e))===y.e.val(y.c.cadr(e)))}),a(">",function(e){return y.a.fromBoolean(y.e.val(y.c.car(e))>y.e.val(y.c.cadr(e)))}),a("<",function(e){return y.a.fromBoolean(y.e.val(y.c.car(e))<y.e.val(y.c.cadr(e)))}),a("*",function(e){return new y.e(y.e.val(y.c.car(e))*y.e.val(y.c.cadr(e)))}),a("-",function(e){return new y.e(y.e.val(y.c.car(e))-y.e.val(y.c.cadr(e)))}),a("+",function(e){return new y.e(y.e.val(y.c.car(e))+y.e.val(y.c.cadr(e)))}),a("/",function(e){return new y.e(y.e.val(y.c.car(e))/y.e.val(y.c.cadr(e)))}),a("min",function(e){return new y.e(Math.min(y.e.val(y.c.car(e)),y.e.val(y.c.cadr(e))))}),a("max",function(e){return new y.e(Math.max(y.e.val(y.c.car(e)),y.e.val(y.c.cadr(e))))}),a("abs",function(e){return new y.e(Math.abs(y.e.val(y.c.car(e))))}),a("zero?",function(e){return y.a.fromBoolean(0===y.e.val(y.c.car(e)))}),a("length",function(e){return y.c.lengthI(y.c.car(e))}),a("not",function(e){return y.a.not(y.c.car(e))}),a("and",function(e){return y.a.and(e)}),a("or",function(e){return y.a.or(e)}),a("display",function(e){for(;!y.c.isNil(e);)t(y.c.car(e).toDisplayString()),e=y.c.cdr(e);return y.c.Nil}),a("ask",function(e){for(var n="";!y.c.isNil(e);)n+=y.c.car(e).toDisplayString(),e=y.c.cdr(e);t("> "+n+" ");var r=parseInt(prompt(n),10);return t(r+"\n"),new y.e(r)}),this.evaluator=new S,this.evaluator.setEvaluators([new O(this.evaluator),new I,new D,new L(this.evaluator),new N(this.evaluator),new T(this.evaluator),new P(this.evaluator),new B(this.evaluator),new x(this.evaluator),new E(this.evaluator),new C(this.evaluator),new j(this.evaluator),new w(this.evaluator)]),this.evaluator.evaluateList(n,new _(r),function(e){return e})}},{key:"step",value:function(e,t){if(this.evaluator.setStepCount(t),y.b.matches(e))for(e=e.val()();y.d.matches(e);)e=y.d.call(e);return y.b.matches(e)?e:null}}]),e}();function F(e){if("paused"!==e.kind)return null;for(var t=new p(e.sv,e.sv.env()),n=0;t&&n<e.currentStackFrameIndex;n++)t=t.parent();return t}var M=function(e){var t=e.samples.map(function(e){var t=e.split("\n")[0].trim().replace(/^; /,"");return a.a.createElement("option",{key:e},t)});return a.a.createElement("select",{className:"sicp-editor-select-sample",onChange:function(t){e.onSampleSelected(t.target.selectedIndex)}},t)},R=function(e){return a.a.createElement("div",{className:"sicp-editor-toolbar"},e.onRun&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onRun},"run"),e.onPause&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onPause},"pause"),e.onStop&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onStop},"stop"),e.onStep&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onStep},"step"),e.onContinue&&a.a.createElement("button",{className:"sicp-editor-button",onClick:e.onContinue},"continue"),a.a.createElement(M,{samples:e.samples,onSampleSelected:e.onSampleSelected}))},A=function(e){var t=F(e.debuggerState);if(null==t)return a.a.createElement("div",{className:"sicp-stack-frame"},a.a.createElement("p",null,"not paused"));for(var n=t.env(),r=[];n;)r.push(a.a.createElement("div",null,a.a.createElement("p",{className:"sicp-tree-node-title"},"Scope"),n.getNames().length>0&&a.a.createElement("div",{className:"sicp-tree-node-content"},n.getNames().map(function(e){return a.a.createElement("div",{key:e},a.a.createElement("div",{className:"sicp-variable-name"},e),a.a.createElement("div",{className:"sicp-variable-value"},n.get(e).toDisplayString()))})),0===n.getNames().length&&a.a.createElement("p",{className:"sicp-scope-empty"},"\xabempty\xbb"))),n=n.getEnvParent();return a.a.createElement("div",null,r)},W=function(e){var t=e.debuggerState;if("paused"!==t.kind||!y.b.matches(t.sv))return a.a.createElement("div",{className:"sicp-stack-frame"},a.a.createElement("p",null,"not paused"));for(var n=t.sv,r=new p(n,n.env()),i=0,u=[],c=function(){for(var n=i,c=r.env();null!=c&&null==c.getSvSymbolProcedure();)c=c.getEnvParent();var o="(\xablambda\xbb)";if(null!=c){o="("+c.getSvSymbolProcedure().toString();var l,v=Object(s.a)(c.getNames());try{for(v.s();!(l=v.n()).done;){var d=l.value;o+=" "+c.get(d).toString()}}catch(f){v.e(f)}finally{v.f()}o+=")"}var h="sicp-stack-frame "+(n===t.currentStackFrameIndex?"sicp-stack-frame-current":"");u.push(a.a.createElement("div",{className:h,key:i,onClick:function(){return e.onStackFrameSelect(n)}},a.a.createElement("p",null,o))),r=r.parent(),i++};r;)c();return a.a.createElement("div",null,u)},U=function(){function e(){var t=this;Object(d.a)(this,e),this.output=void 0,this.log=function(e){t.output+=e}}return Object(h.a)(e,[{key:"clear",value:function(){this.output=""}}]),e}(),q=function(e){if(!e.text)return a.a.createElement("div",null);var t=e.text.split("\n").map(function(e){return a.a.createElement("div",null,e)});return a.a.createElement("div",null,t)},V=function(e){Object(f.a)(n,e);var t=Object(m.a)(n);function n(e){var r;return Object(d.a)(this,n),(r=t.call(this,e)).setSampleIndex=function(e){var t;r.stop(),r.setState({program:null!==(t=r.state.samples[e])&&void 0!==t?t:"",currentSampleIndex:e})},r.run=function(){r.setState({debuggerState:{kind:"running",sv:null}})},r.stop=function(){"stopped"!==r.state.debuggerState.kind&&r.setState({debuggerState:{kind:"stopped"}})},r.step=function(){var e=r.state.debuggerState;"paused"===e.kind?r.stepInterpreter(Object(v.a)(Object(v.a)({},r.state),{},{debuggerState:Object(v.a)(Object(v.a)({},e),{},{kind:"step"})})):"stopped"===e.kind&&r.stepInterpreter(Object(v.a)(Object(v.a)({},r.state),{},{debuggerState:{kind:"step",sv:null}}))},r.cont=function(){var e=r.state.debuggerState;"paused"===e.kind&&r.setState({debuggerState:Object(v.a)(Object(v.a)({},e),{},{kind:"running"})})},r.pause=function(){var e=r.state.debuggerState;"running"===e.kind&&y.b.matches(e.sv)&&r.setState({debuggerState:{kind:"paused",sv:e.sv,currentStackFrameIndex:0}})},r.setStackFrameIndex=function(e){var t=r.state.debuggerState;"paused"===t.kind&&r.setState({debuggerState:Object(v.a)(Object(v.a)({},t),{},{kind:"paused",currentStackFrameIndex:e})})},r.edit=function(e){r.stop(),r.setState({program:e})},r.stepInterpreter=function(e){var t=e.debuggerState,n=e.interpreter,a=e.logger,i=e.program;if("running"===t.kind||"step"===t.kind)try{var u=t.sv;null==u?(r.stop(),a.clear(),u=n.evaluateString(i,a.log)):u=n.step(t.sv,"running"===t.kind?1e4:1),null==u?r.setState({debuggerState:{kind:"stopped"}}):"running"===t.kind?r.setState({debuggerState:{kind:"running",sv:u}}):y.b.matches(u)?r.setState({debuggerState:{kind:"paused",sv:u,currentStackFrameIndex:0}}):r.setState({debuggerState:{kind:"stopped"}})}catch(c){console.log(c),a.log("\n"+c),r.setState({debuggerState:{kind:"stopped"}})}},r.state={program:"",samples:[],currentSampleIndex:0,logger:new U,interpreter:new K,debuggerState:{kind:"stopped"},editorRef:a.a.createRef()},function(){var t=Object(l.a)(o.a.mark(function t(){var n,r,a,i,u;return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=[],r=Object(s.a)(e.sampleUrls),t.prev=2,r.s();case 4:if((a=r.n()).done){t.next=16;break}return i=a.value,t.next=8,fetch(i);case 8:return u=t.sent,t.t0=n,t.next=12,u.text();case 12:t.t1=t.sent,t.t0.push.call(t.t0,t.t1);case 14:t.next=4;break;case 16:t.next=21;break;case 18:t.prev=18,t.t2=t.catch(2),r.e(t.t2);case 21:return t.prev=21,r.f(),t.finish(21);case 24:return t.abrupt("return",n);case 25:case"end":return t.stop()}},t,null,[[2,18,21,24]])}));return function(){return t.apply(this,arguments)}}()().then(function(e){r.setState({samples:e}),r.setSampleIndex(0)}),r}return Object(h.a)(n,[{key:"render",value:function(){var e=this,t=this.state,n=t.samples,r=t.debuggerState,i=t.editorRef,u=t.logger,c=t.program;"running"!==r.kind&&"step"!==r.kind||setTimeout(function(){return e.stepInterpreter(e.state)},0);var o,s=[],l=F(r);"paused"===r.kind&&null!=l&&(s.push({startRow:l.sv().ilineStart,endRow:l.sv().ilineEnd,startCol:l.sv().icolStart,endCol:l.sv().icolEnd,className:"current-statement",type:"text"}),null===(o=i.current)||void 0===o||o.editor.gotoLine(l.sv().ilineStart));return a.a.createElement("div",{id:"editor-wrap"},a.a.createElement("div",{id:"editor"},a.a.createElement(R,{samples:n,onSampleSelected:this.setSampleIndex,onRun:"stopped"===r.kind?this.run:null,onStop:"paused"===r.kind||"running"===r.kind?this.stop:null,onPause:"running"===r.kind?this.pause:null,onStep:"paused"===r.kind||"stopped"===r.kind?this.step:null,onContinue:"paused"===r.kind?this.cont:null}),a.a.createElement(g.a,{ref:i,onChange:this.edit,className:"editorWindow",mode:"typescript",theme:"tomorrow_night",name:"ace-editor",editorProps:{$blockScrolling:!1},value:c,showGutter:!0,width:"auto",height:"auto",markers:s})),a.a.createElement("div",{id:"editor-bottom"},a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Output"),a.a.createElement("div",{id:"output-content",className:"sicp-box-tab-content"},a.a.createElement(q,{text:u.output}))),a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Call Stack"),a.a.createElement("div",{id:"stacktrace-content",className:"sicp-box-tab-content"},a.a.createElement(W,{debuggerState:r,onStackFrameSelect:this.setStackFrameIndex}))),a.a.createElement("div",{className:"sicp-box"},a.a.createElement("p",{className:"sicp-box-tab-title"},"Variables"),a.a.createElement("div",{id:"variables-content",className:"sicp-box-tab-content"},a.a.createElement(A,{debuggerState:r})))))}}]),n}(a.a.PureComponent),H=["samples/factorial.ms","samples/odd-or-even.ms","samples/counting-change.ms","samples/hanoi.ms","samples/n-queens.ms","samples/return-with-callcc.ms","samples/lazy-generator.ms","samples/yin-yang.ms"];var Q=function(){return a.a.createElement(a.a.Fragment,null,a.a.createElement("div",{id:"header"},a.a.createElement("h2",null,"Mini scheme"),a.a.createElement("p",null,"by ",a.a.createElement("a",{href:"https://csokavar.hu"},"encse"))),a.a.createElement(V,{sampleUrls:H}),a.a.createElement("div",{id:"footer"},"Copyright 2015, source is available on ",a.a.createElement("a",{href:"https://github.com/encse/sicp"},"GitHub")))},J=document.getElementById("root");u.a.render(a.a.createElement(Q,null),J)}},[[21,1,2]]]);
//# sourceMappingURL=main.f347493a.chunk.js.map